<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>W4L1: Text Analysis and Entity Resolution Lab - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/jquery-ui-bundle/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/img/favicon.ico"/>
<script>window.settings = {"enableSshKeyUI":true,"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","workspaceFeaturedLinks":[{"linkURI":"https://docs.cloud.databricks.com/docs/latest/databricks_guide/index.html","displayName":"Databricks Guide","icon":"question"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/sample_applications/index.html","displayName":"Application Examples","icon":"code"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/courses/index.html","displayName":"Training","icon":"graduation-cap"}],"dbcForumURL":"http://forums.databricks.com/","nodeInfo":{"node_types":[{"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":8.0,"node_type_id":"dev-tier-node","description":"Community Optimized","container_memory_mb":6000,"memory_mb":6144,"category":"Community Edition","num_cores":0.88,"support_ebs_volumes":false}],"default_node_type_id":"dev-tier-node"},"enableThirdPartyApplicationsUI":false,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":999999,"enableTableHandler":true,"maxEbsVolumesPerInstance":10,"isAdmin":true,"deltaProcessingBatchSize":1000,"enableLargeResultDownload":true,"zoneInfos":[{"id":"us-west-2c","isDefault":true},{"id":"us-west-2b","isDefault":false},{"id":"us-west-2a","isDefault":false}],"enableEBSVolumesUIForJobs":false,"enablePublishNotebooks":true,"enableJobAclsConfig":false,"enableFullTextSearch":false,"enableElasticSparkUI":false,"clusters":true,"allowRunOnPendingClusters":true,"applications":false,"fileStoreBase":"FileStore","enableSshKeyUIInJobs":true,"configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableAdminPasswordReset":false,"enableResetPassword":true,"enableJobsSparkUpgrade":true,"sparkVersions":[{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1)","packageLabel":"spark-image-f710650fb8aaade8e4e812368ea87c45cd8cd0b5e6894ca6c94f3354e8daa6dc","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"master","displayName":"Spark master (dev)","packageLabel":"","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop2","displayName":"Spark 1.6.2 (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-image-4cafdf8bc6cba8edad12f441e3b3f0a8ea27da35c896bc8290e16b41fd15496a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-ubuntu15.10-scala2.11","displayName":"Spark 2.0 (Scala 2.11)","packageLabel":"spark-image-2ed723ed81c23b57d4ac31a93a7e2e72a847957bd1a81a173b8e49aba9ff0fb7","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1)","packageLabel":"spark-image-c9d2a8abf41f157a4acc6d52bc721090346f6fea2de356f3a66e388f54481698","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1)","packageLabel":"spark-image-40d2842670bc3dc178b14042501847d76171437ccf70613fa397a7a24c48b912","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (Scala 2.10)","packageLabel":"spark-image-007dd0b32332bffcba261806f005dfd759d17fdbd32b91b2acc2044e8be01919","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-image-10ef758029b8c7e19cd7f4fb52fff9180d75db92ca071bd94c47f3c1171a7cb5","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":false}],"enableRestrictedClusterCreation":true,"enableFeedback":true,"enableClusterAutoScaling":false,"defaultNumWorkers":0,"serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"accountsOwnerUrl":"https://accounts.cloud.databricks.com/registration.html#login","driverStdoutFilePrefix":"stdout","defaultNodeTypeToPricingUnitsMap":{"r3.2xlarge":2,"class-node":1,"r3.8xlarge":8,"dev-tier-node":1,"c3.8xlarge":4,"r3.4xlarge":4,"i2.4xlarge":6,"development-node":1,"i2.2xlarge":3,"memory-optimized":1,"c3.2xlarge":1,"c4.2xlarge":1,"i2.xlarge":1.5,"compute-optimized":1,"c4.4xlarge":2,"c3.4xlarge":2,"c4.8xlarge":4,"r3.xlarge":1,"i2.8xlarge":12},"enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"enableEBSVolumesUI":false,"sanitizeMarkdownHtml":true,"enableIPythonImportExport":true,"enableNotebookHistoryDiffing":true,"branch":"2.27.1","accountsLimit":3,"enableX509Authentication":false,"enableNotebookGitBranching":true,"local":false,"enableClusterAutoScalingForJobs":false,"enableStrongPassword":false,"displayDefaultContainerMemoryGB":6,"disableS3TableImport":false,"deploymentMode":"production","useSpotForWorkers":true,"enableUserInviteWorkflow":true,"enableStaticNotebooks":true,"enableCssTransitions":true,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterAclsConfig":false,"useTempS3UrlForTableUpload":false,"notifyLastLogin":false,"enableNotebookGitVersioning":true,"files":"files/","feedbackEmail":"feedback@databricks.com","enableDriverLogsUI":true,"disableLegacyDashboards":true,"enableWorkspaceAclsConfig":false,"dropzoneMaxFileSize":4096,"enableNewDashboardViews":true,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"deltaProcessingAsyncEnabled":true,"defaultSparkVersion":{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":true},"enableCustomSpotPricing":true,"enableMountAclsConfig":false,"enablePublishHub":false,"notebookHubUrl":"http://hub.dev.databricks.com/","showSqlEndpoints":false,"enableClusterAclsByTier":false,"disallowAddingAdmins":true,"enableSparkConfUI":true,"featureTier":"DEVELOPER_BASIC_TIER","enableOrgSwitcherUI":true,"clustersLimit":1,"enableJdbcImport":true,"logfiles":"logfiles/","enableWebappSharding":true,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"useFixedStaticNotebookVersionForDevelopment":false,"ebsVolumeSizeLimitGB":{"GENERAL_PURPOSE_SSD":[100,4096],"THROUGHPUT_OPTIMIZED_HDD":[500,4096]},"enableMountAcls":false,"requireEmailUserName":true,"enableDashboardViews":false,"dbcFeedbackURL":"mailto:feedback@databricks.com","enableMountAclService":true,"enableWorkspaceAclService":true,"docsDomain":"https://docs.cloud.databricks.com/","enableWorkspaceAcls":false,"gitHash":"20160901120019","showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","allowFeedbackForumAccess":true,"enableImportFromUrl":true,"enableMiniClusters":true,"showDevTierBetaVersion":true,"enableDebugUI":false,"allowNonAdminUsers":true,"enableSingleSignOnByTier":false,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/","enableSparkPackages":true,"dynamicSparkVersions":true,"enableNotebookHistoryUI":true,"showDebugCounters":false,"enableFolderHtmlExport":true,"enableSparkVersionsUI":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.cloud.databricks.com/docs/latest/featured_notebooks/A%20Gentle%20Introduction%20to%20Apache%20Spark%20on%20Databricks.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/featured_notebooks/Quick%20Start%20DataFrames.html","displayName":"Quick Start DataFrames","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/featured_notebooks/GSW%20Passing%20Analysis%20(new).html","displayName":"GSW Passing Analysis (new)","icon":"img/home/Python_icon.svg"}],"upgradeURL":"https://accounts.cloud.databricks.com/registration.html#login","notebookLoadingBackground":"#fff","sshContainerForwardedPort":2200,"enableServerAutoComplete":true,"enableStaticHtmlImport":true,"enableTerminal":false,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"accounts":true,"useFramedStaticNotebooks":true,"enableNewProgressReportUI":true,"defaultCoresPerContainer":4,"showSqlProxyUI":true};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":2632367762420743,"name":"W4L1: Text Analysis and Entity Resolution Lab","language":"python","commands":[{"version":"CommandV1","origId":2632367762420745,"guid":"073f4ed4-e09e-4249-af83-efd806791093","subtype":"command","commandType":"auto","position":2.0,"command":"%md\n<a rel=\"license\" href=\"http://creativecommons.org/licenses/by-nc-nd/4.0/\"><img alt=\"Creative Commons License\" style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png\" /></a><br />This work is licensed under a <a rel=\"license\" href=\"http://creativecommons.org/licenses/by-nc-nd/4.0/\">Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License</a>.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.470072580582E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"87ed2f9f-4618-4cd5-86a7-6ddb4a38556b"},{"version":"CommandV1","origId":2632367762420746,"guid":"5a88de79-07d1-4dc1-8213-62c9fa62e562","subtype":"command","commandType":"auto","position":2.5,"command":"%md\nBefore beginning this lab exercise, please watch the lectures for module four.  They can be found in \"Module 4: Lectures\" notebook.\n\nBased on the EdX Course by DataBricks -- Big Data Analysis with Apache Spark","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.47007258059E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"1c340f05-15ae-45b3-951b-c3daf949379f"},{"version":"CommandV1","origId":2632367762420747,"guid":"ac9bab16-361a-4f36-99d8-7ee9c7220af7","subtype":"command","commandType":"auto","position":3.0,"command":"%md\n#![Spark Logo](http://spark-mooc.github.io/web-assets/images/ta_Spark-logo-small.png) + ![Python Logo](http://spark-mooc.github.io/web-assets/images/python-logo-master-v3-TM-flattened_small.png)\n# **Text Analysis and Entity Resolution**\nEntity resolution is a common, yet difficult problem in data cleaning and integration. This lab will demonstrate how we can use Apache Spark to apply powerful and scalable text analysis techniques and perform entity resolution across two datasets of commercial products.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.470072580627E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"e2d550aa-5789-4bbc-83f8-744abbe9b1a8"},{"version":"CommandV1","origId":2632367762420748,"guid":"c8718551-a0e3-4973-8457-575b0eea239a","subtype":"command","commandType":"auto","position":4.0,"command":"%md\nEntity Resolution, or \"[Record linkage][wiki]\" is the term used by statisticians, epidemiologists, and historians, among others, to describe the process of joining records from one data source with another that describe the same entity. Our terms with the same meaning include, \"entity disambiguation/linking\", duplicate detection\", \"deduplication\", \"record matching\", \"(reference) reconciliation\", \"object identification\", \"data/information integration\", and \"conflation\".\n \nEntity Resolution (ER) refers to the task of finding records in a dataset that refer to the same entity across different data sources (e.g., data files, books, websites, databases). ER is necessary when joining datasets based on entities that may or may not share a common identifier (e.g., database key, URI, National identification number), as may be the case due to differences in record shape, storage location, and/or curator style or preference. A dataset that has undergone ER may be referred to as being cross-linked.\n[wiki]: https://en.wikipedia.org/wiki/Record_linkage","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.470072580659E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"0191b251-09ba-492b-97a9-c6b13f8c8a18"},{"version":"CommandV1","origId":2632367762420749,"guid":"8c8588e7-359a-4adb-b273-f0ac3a2969e9","subtype":"command","commandType":"auto","position":5.0,"command":"labVersion = 'cs100.1x-lab3-1.0.4'","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.470072583915E12,"submitTime":1.470072580694E12,"finishTime":1.470072584014E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"73f71b7a-db4b-4715-a95f-290bc99160ef"},{"version":"CommandV1","origId":2632367762420750,"guid":"53abe0e7-9dc1-49cd-a769-e959aa08e897","subtype":"command","commandType":"auto","position":6.0,"command":"%md\n#### Code\nThis assignment can be completed using basic Python, pySpark Transformations and actions, and the plotting library matplotlib. Other libraries are not allowed.\n \n#### Files\nData files for this assignment are from the [metric-learning](https://code.google.com/p/metric-learning/) project and can be found at:\n`cs100/lab3`\n \nThe directory contains the following files:\n* **Google.csv**, the Google Products dataset\n* **Amazon.csv**, the Amazon dataset\n* **Google_small.csv**, 200 records sampled from the Google data\n* **Amazon_small.csv**, 200 records sampled from the Amazon data\n* **Amazon_Google_perfectMapping.csv**, the \"gold standard\" mapping\n* **stopwords.txt**, a list of common English words\n \nBesides the complete data files, there are \"sample\" data files for each dataset - we will use these for **Part 1**. In addition, there is a \"gold standard\" file that contains all of the true mappings between entities in the two datasets. Every row in the gold standard file has a pair of record IDs (one Google, one Amazon) that belong to two record that describe the same thing in the real world. We will use the gold standard to evaluate our algorithms.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.470072580718E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"68a229f5-d634-433b-8eae-adfb16a3921c"},{"version":"CommandV1","origId":2632367762420751,"guid":"08aeec15-a865-444e-b48f-20b4f7ba5f3d","subtype":"command","commandType":"auto","position":7.0,"command":"%md\n#### **Part 0: Preliminaries**\nWe read in each of the files and create an RDD consisting of lines.\nFor each of the data files (\"Google.csv\", \"Amazon.csv\", and the samples), we want to parse the IDs out of each record. The IDs are the first column of the file (they are URLs for Google, and alphanumeric strings for Amazon). Omitting the headers, we load these data files into pair RDDs where the *mapping ID* is the key, and the value is a string consisting of the name/title, description, and manufacturer from the record.\n \nThe file format of an Amazon line is:\n \n   `\"id\",\"title\",\"description\",\"manufacturer\",\"price\"`\n \nThe file format of a Google line is:\n \n   `\"id\",\"name\",\"description\",\"manufacturer\",\"price\"`","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.470072580752E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"62d8798f-fba2-47eb-9f7e-7339e6c82c8d"},{"version":"CommandV1","origId":2632367762420752,"guid":"7cdd0d1e-cddf-4111-86d2-28b73233c8d9","subtype":"command","commandType":"auto","position":8.0,"command":"import re\nDATAFILE_PATTERN = '^(.+),\"(.+)\",(.*),(.*),(.*)'\n\ndef removeQuotes(s):\n    \"\"\" Remove quotation marks from an input string\n    Args:\n        s (str): input string that might have the quote \"\" characters\n    Returns:\n        str: a string without the quote characters\n    \"\"\"\n    return ''.join(i for i in s if i!='\"')\n\n\ndef parseDatafileLine(datafileLine):\n    \"\"\" Parse a line of the data file using the specified regular expression pattern\n    Args:\n        datafileLine (str): input string that is a line from the data file\n    Returns:\n        str: a string parsed using the given regular expression and without the quote characters\n    \"\"\"\n    match = re.search(DATAFILE_PATTERN, datafileLine)\n    if match is None:\n        print 'Invalid datafile line: %s' % datafileLine\n        return (datafileLine, -1)\n    elif match.group(1) == '\"id\"':\n        print 'Header datafile line: %s' % datafileLine\n        return (datafileLine, 0)\n    else:\n        product = '%s %s %s' % (match.group(2), match.group(3), match.group(4))\n        return ((removeQuotes(match.group(1)), product), 1)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax","error":"<div class=\"ansiout\"><span class=\"ansicyan\">  File </span><span class=\"ansigreen\">&quot;&lt;ipython-input-2-6d6eae959232&gt;&quot;</span><span class=\"ansicyan\">, line </span><span class=\"ansigreen\">11</span>\n<span class=\"ansiyellow\">    return &lt;FILL IN&gt;</span>\n<span class=\"ansigrey\">           ^</span>\n<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax\n\n</div>","workflows":[],"startTime":1.470072584167E12,"submitTime":1.470072580797E12,"finishTime":1.470072584243E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"6552ae08-478c-44c7-bece-58bc1a22d615"},{"version":"CommandV1","origId":2632367762420753,"guid":"4cee6759-487d-4dcb-89fe-4a7cca6b88f8","subtype":"command","commandType":"auto","position":9.5,"command":"%md **WARNING:** If *test_helper*, required in the cell below, is not installed, follow the instructions [here](https://databricks-staging-cloudfront.staging.cloud.databricks.com/public/c65da9a2fa40e45a2028cddebe45b54c/8637560089690848/4187311313936645/6977722904629137/05f3c2ecc3.html).","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.470072580821E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"737aaa73-61c3-4dc9-b3fb-78cc8e579b32"},{"version":"CommandV1","origId":2632367762420754,"guid":"668202c4-ea0f-4f50-bf31-5cf40817b5cb","subtype":"command","commandType":"auto","position":10.0,"command":"import sys\nimport os\nfrom test_helper import Test\n\nbaseDir = os.path.join('databricks-datasets')\ninputPath = os.path.join('cs100', 'lab3', 'data-001')\n\nGOOGLE_PATH = 'Google.csv'\nGOOGLE_SMALL_PATH = 'Google_small.csv'\nAMAZON_PATH = 'Amazon.csv'\nAMAZON_SMALL_PATH = 'Amazon_small.csv'\nGOLD_STANDARD_PATH = 'Amazon_Google_perfectMapping.csv'\nSTOPWORDS_PATH = 'stopwords.txt'\n\ndef parseData(filename):\n    \"\"\" Parse a data file\n    Args:\n        filename (str): input file name of the data file\n    Returns:\n        RDD: a RDD of parsed lines\n    \"\"\"\n    return (sc\n            .textFile(filename, 4, 0)\n            .map(parseDatafileLine))\n\ndef loadData(path):\n    \"\"\" Load a data file\n    Args:\n        path (str): input file name of the data file\n    Returns:\n        RDD: a RDD of parsed valid lines\n    \"\"\"\n    filename = os.path.join(baseDir, inputPath, path)\n    raw = parseData(filename).cache()\n    failed = (raw\n              .filter(lambda s: s[1] == -1)\n              .map(lambda s: s[0]))\n    for line in failed.take(10):\n        print '%s - Invalid datafile line: %s' % (path, line)\n    valid = (raw\n             .filter(lambda s: s[1] == 1)\n             .map(lambda s: s[0])\n             .cache())\n    print '%s - Read %d lines, successfully parsed %d lines, failed to parse %d lines' % (path,\n                                                                                        raw.count(),\n                                                                                        valid.count(),\n                                                                                        failed.count())\n    assert failed.count() == 0\n    assert raw.count() == (valid.count() + 1)\n    return valid\n\ngoogleSmall = loadData(GOOGLE_SMALL_PATH)\ngoogle = loadData(GOOGLE_PATH)\namazonSmall = loadData(AMAZON_SMALL_PATH)\namazon = loadData(AMAZON_PATH)\n","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Google_small.csv - Read 201 lines, successfully parsed 200 lines, failed to parse 0 lines\nGoogle.csv - Read 3227 lines, successfully parsed 3226 lines, failed to parse 0 lines\nAmazon_small.csv - Read 201 lines, successfully parsed 200 lines, failed to parse 0 lines\nAmazon.csv - Read 1364 lines, successfully parsed 1363 lines, failed to parse 0 lines\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.470072584251E12,"submitTime":1.470072580856E12,"finishTime":1.470072589397E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"d747325a-b4a6-4c9f-b7f3-c67591623d03"},{"version":"CommandV1","origId":2632367762420755,"guid":"659b98ff-e448-4aa8-9cc4-326f00cb9c51","subtype":"command","commandType":"auto","position":11.0,"command":"%md\nLet's examine the lines that were just loaded in the two subset (small) files - one from Google and one from Amazon","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.470072580884E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"d2c83a1c-b77e-45b9-b879-e6ad2295c320"},{"version":"CommandV1","origId":2632367762420756,"guid":"961b095a-dce1-40aa-81dc-74812f706be4","subtype":"command","commandType":"auto","position":12.0,"command":"for line in googleSmall.take(3):\n    print 'google: %s: %s\\n' % (line[0], line[1])\n\nfor line in amazonSmall.take(3):\n    print 'amazon: %s: %s\\n' % (line[0], line[1])","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">google: http://www.google.com/base/feeds/snippets/11448761432933644608: spanish vocabulary builder &quot;expand your vocabulary! contains fun lessons that both teach and entertain you&apos;ll quickly find yourself mastering new terms. includes games and more!&quot; \n\ngoogle: http://www.google.com/base/feeds/snippets/8175198959985911471: topics presents: museums of world &quot;5 cd-rom set. step behind the velvet rope to examine some of the most treasured collections of antiquities art and inventions. includes the following the louvre - virtual visit 25 rooms in full screen interactive video detailed map of the louvre ...&quot; \n\ngoogle: http://www.google.com/base/feeds/snippets/18445827127704822533: sierrahome hse hallmark card studio special edition win 98 me 2000 xp &quot;hallmark card studio special edition (win 98 me 2000 xp)&quot; &quot;sierrahome&quot;\n\namazon: b000jz4hqo: clickart 950 000 - premier image pack (dvd-rom)  &quot;broderbund&quot;\n\namazon: b0006zf55o: ca international - arcserve lap/desktop oem 30pk &quot;oem arcserve backup v11.1 win 30u for laptops and desktops&quot; &quot;computer associates&quot;\n\namazon: b00004tkvy: noah&apos;s ark activity center (jewel case ages 3-8)  &quot;victory multimedia&quot;\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.470072589409E12,"submitTime":1.470072580918E12,"finishTime":1.470072589583E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"3adcc396-af2a-49eb-be0e-4381f4b30933"},{"version":"CommandV1","origId":2632367762420757,"guid":"aef6014b-3ed8-49b8-89e6-d2fc21018137","subtype":"command","commandType":"auto","position":13.0,"command":"%md\n#### **Part 1: ER as Text Similarity - Bags of Words**\n \nA simple approach to entity resolution is to treat all records as strings and compute their similarity with a string distance function. In this part, we will build some components for performing bag-of-words text-analysis, and then use them to compute record similarity.\n[Bag-of-words][bag-of-words] is a conceptually simple yet powerful approach to text analysis.\n \nThe idea is to treat strings, a.k.a. **documents**, as *unordered collections* of words, or **tokens**, i.e., as bags of words.\n> **Note on terminology**: a \"token\" is the result of parsing the document down to the elements we consider \"atomic\" for the task at hand.  Tokens can be things like words, numbers, acronyms, or other exotica like word-roots or fixed-length character strings.\n> Bag of words techniques all apply to any sort of token, so when we say \"bag-of-words\" we really mean \"bag-of-tokens,\" strictly speaking.\nTokens become the atomic unit of text comparison. If we want to compare two documents, we count how many tokens they share in common. If we want to search for documents with keyword queries (this is what Google does), then we turn the keywords into tokens and find documents that contain them. The power of this approach is that it makes string comparisons insensitive to small differences that probably do not affect meaning much, for example, punctuation and word order.\n[bag-of-words]: https://en.wikipedia.org/wiki/Bag-of-words_model","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.470072580949E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"cbd1e328-d0f4-4bdf-b28b-6b9f824691ef"},{"version":"CommandV1","origId":2632367762420758,"guid":"7fdf0432-8869-45c0-85ce-9aaa4dbc477b","subtype":"command","commandType":"auto","position":14.0,"command":"%md\n#### **1(a) Tokenize a String**\nImplement the function `simpleTokenize(string)` that takes a string and returns a list of non-empty tokens in the string. `simpleTokenize` should split strings using the provided regular expression. Since we want to make token-matching case insensitive, make sure all tokens are turned lower-case. Give an interpretation, in natural language, of what the regular expression, `split_regex`, matches.\nIf you need help with Regular Expressions, try the site [regex101](https://regex101.com/) where you can interactively explore the results of applying different regular expressions to strings. *Note that \\W includes the \"_\" character*.  You should use [re.split()](https://docs.python.org/2/library/re.html#re.split) to perform the string split. Also, make sure you remove any empty tokens.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.470072580979E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"850cd126-a735-463a-9344-c215b2ac54ca"},{"version":"CommandV1","origId":2632367762420759,"guid":"861e9026-4afc-42b0-984e-070295deb110","subtype":"command","commandType":"auto","position":15.0,"command":"# TODO: Replace <FILL IN> with appropriate code\nquickbrownfox = 'A quick brown fox jumps over the lazy dog.'\nsplit_regex = r'\\W+'\n\ndef simpleTokenize(string):\n    \"\"\" A simple implementation of input string tokenization\n    Args:\n        string (str): input string\n    Returns:\n        list: a list of tokens\n    \"\"\"\n    return filter(lambda string: string != '', re.split(split_regex, string.lower()))\n\nprint simpleTokenize(quickbrownfox) # Should give ['a', 'quick', 'brown', ... ]","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">[&apos;a&apos;, &apos;quick&apos;, &apos;brown&apos;, &apos;fox&apos;, &apos;jumps&apos;, &apos;over&apos;, &apos;the&apos;, &apos;lazy&apos;, &apos;dog&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.47007258959E12,"submitTime":1.470072581009E12,"finishTime":1.470072589615E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"134b29ac-694c-48b9-adc4-67c06c306bea"},{"version":"CommandV1","origId":2632367762420760,"guid":"2dc4b86d-89dd-4e31-8d25-65062253c896","subtype":"command","commandType":"auto","position":16.0,"command":"# TEST Tokenize a String (1a)\nTest.assertEquals(simpleTokenize(quickbrownfox),\n                  ['a','quick','brown','fox','jumps','over','the','lazy','dog'],\n                  'simpleTokenize should handle sample text')\nTest.assertEquals(simpleTokenize(' '), [], 'simpleTokenize should handle empty string')\nTest.assertEquals(simpleTokenize('!!!!123A/456_B/789C.123A'), ['123a','456_b','789c','123a'],\n                  'simpleTokenize should handle punctuations and lowercase result')\nTest.assertEquals(simpleTokenize('fox fox'), ['fox', 'fox'],\n                  'simpleTokenize should not remove duplicates')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.470072589624E12,"submitTime":1.470072581033E12,"finishTime":1.470072589668E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"97dc4ec1-9d08-4929-a932-438df42e1013"},{"version":"CommandV1","origId":2632367762420761,"guid":"27aeb4ea-57b3-4a06-8d62-82515c5bd416","subtype":"command","commandType":"auto","position":17.0,"command":"%md\n#### **(1b) Removing stopwords**\n*[Stopwords][stopwords]* are common (English) words that do not contribute much to the content or meaning of a document (e.g., \"the\", \"a\", \"is\", \"to\", etc.). Stopwords add noise to bag-of-words comparisons, so they are usually excluded.\nUsing the included file \"stopwords.txt\", implement `tokenize`, an improved tokenizer that does not emit stopwords.\n[stopwords]: https://en.wikipedia.org/wiki/Stop_words","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.470072581057E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"ca57d7fb-67d6-4e72-90d3-3c1af0557431"},{"version":"CommandV1","origId":2632367762420762,"guid":"b2ae8ea2-86ef-4eed-a7c9-0255b826ebdc","subtype":"command","commandType":"auto","position":18.0,"command":"# TODO: Replace <FILL IN> with appropriate code\nstopfile = os.path.join(baseDir, inputPath, STOPWORDS_PATH)\nstopwords = set(sc.textFile(stopfile).collect())\nprint 'These are the stopwords: %s' % stopwords\n\ndef tokenize(string):\n    \"\"\" An implementation of input string tokenization that excludes stopwords\n    Args:\n        string (str): input string\n    Returns:\n        list: a list of tokens without stopwords\n    \"\"\"\n    return filter(lambda tokens: tokens not in stopwords, simpleTokenize(string))\n\nprint tokenize(quickbrownfox) # Should give ['quick', 'brown', ... ]","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">These are the stopwords: set([u&apos;all&apos;, u&apos;just&apos;, u&apos;being&apos;, u&apos;over&apos;, u&apos;both&apos;, u&apos;through&apos;, u&apos;yourselves&apos;, u&apos;its&apos;, u&apos;before&apos;, u&apos;with&apos;, u&apos;had&apos;, u&apos;should&apos;, u&apos;to&apos;, u&apos;only&apos;, u&apos;under&apos;, u&apos;ours&apos;, u&apos;has&apos;, u&apos;do&apos;, u&apos;them&apos;, u&apos;his&apos;, u&apos;very&apos;, u&apos;they&apos;, u&apos;not&apos;, u&apos;during&apos;, u&apos;now&apos;, u&apos;him&apos;, u&apos;nor&apos;, u&apos;did&apos;, u&apos;these&apos;, u&apos;t&apos;, u&apos;each&apos;, u&apos;where&apos;, u&apos;because&apos;, u&apos;doing&apos;, u&apos;theirs&apos;, u&apos;some&apos;, u&apos;are&apos;, u&apos;our&apos;, u&apos;ourselves&apos;, u&apos;out&apos;, u&apos;what&apos;, u&apos;for&apos;, u&apos;below&apos;, u&apos;does&apos;, u&apos;above&apos;, u&apos;between&apos;, u&apos;she&apos;, u&apos;be&apos;, u&apos;we&apos;, u&apos;after&apos;, u&apos;here&apos;, u&apos;hers&apos;, u&apos;by&apos;, u&apos;on&apos;, u&apos;about&apos;, u&apos;of&apos;, u&apos;against&apos;, u&apos;s&apos;, u&apos;or&apos;, u&apos;own&apos;, u&apos;into&apos;, u&apos;yourself&apos;, u&apos;down&apos;, u&apos;your&apos;, u&apos;from&apos;, u&apos;her&apos;, u&apos;whom&apos;, u&apos;there&apos;, u&apos;been&apos;, u&apos;few&apos;, u&apos;too&apos;, u&apos;themselves&apos;, u&apos;was&apos;, u&apos;until&apos;, u&apos;more&apos;, u&apos;himself&apos;, u&apos;that&apos;, u&apos;but&apos;, u&apos;off&apos;, u&apos;herself&apos;, u&apos;than&apos;, u&apos;those&apos;, u&apos;he&apos;, u&apos;me&apos;, u&apos;myself&apos;, u&apos;this&apos;, u&apos;up&apos;, u&apos;will&apos;, u&apos;while&apos;, u&apos;can&apos;, u&apos;were&apos;, u&apos;my&apos;, u&apos;and&apos;, u&apos;then&apos;, u&apos;is&apos;, u&apos;in&apos;, u&apos;am&apos;, u&apos;it&apos;, u&apos;an&apos;, u&apos;as&apos;, u&apos;itself&apos;, u&apos;at&apos;, u&apos;have&apos;, u&apos;further&apos;, u&apos;their&apos;, u&apos;if&apos;, u&apos;again&apos;, u&apos;no&apos;, u&apos;when&apos;, u&apos;same&apos;, u&apos;any&apos;, u&apos;how&apos;, u&apos;other&apos;, u&apos;which&apos;, u&apos;you&apos;, u&apos;who&apos;, u&apos;most&apos;, u&apos;such&apos;, u&apos;why&apos;, u&apos;a&apos;, u&apos;don&apos;, u&apos;i&apos;, u&apos;having&apos;, u&apos;so&apos;, u&apos;the&apos;, u&apos;yours&apos;, u&apos;once&apos;])\n[&apos;quick&apos;, &apos;brown&apos;, &apos;fox&apos;, &apos;jumps&apos;, &apos;lazy&apos;, &apos;dog&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.470072589673E12,"submitTime":1.470072581091E12,"finishTime":1.470072589848E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"657f18a5-7778-46a3-b759-4a3164650a51"},{"version":"CommandV1","origId":2632367762420763,"guid":"af56fcb7-4c3d-4f43-8ad1-2b5b9bbd75a5","subtype":"command","commandType":"auto","position":19.0,"command":"# TEST Removing stopwords (1b)\nTest.assertEquals(tokenize(\"Why a the?\"), [], 'tokenize should remove all stopwords')\nTest.assertEquals(tokenize(\"Being at the_?\"), ['the_'], 'tokenize should handle non-stopwords')\nTest.assertEquals(tokenize(quickbrownfox), ['quick','brown','fox','jumps','lazy','dog'],\n                    'tokenize should handle sample text')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.470072589856E12,"submitTime":1.470072581329E12,"finishTime":1.470072589897E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"644dea04-9303-49ee-a7e6-1e60cde94259"},{"version":"CommandV1","origId":2632367762420764,"guid":"a2c7ce93-a09e-4752-8e92-45a500159790","subtype":"command","commandType":"auto","position":20.0,"command":"%md\n#### **(1c) Tokenizing the small datasets**\nNow let's tokenize the two *small* datasets. For each ID in a dataset, `tokenize` the values, and then count the total number of tokens.\nHow many tokens, total, are there in the two datasets?","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.470072581354E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"4e50f078-59fa-4c34-942f-2d8ce2ee570b"},{"version":"CommandV1","origId":2632367762420765,"guid":"9f595162-b1d7-4688-b739-4c3c59be9685","subtype":"command","commandType":"auto","position":21.0,"command":"# TODO: Replace <FILL IN> with appropriate code\namazonRecToToken = amazonSmall.map(lambda rec: (rec[0], tokenize(rec[1])))\ngoogleRecToToken = googleSmall.map(lambda rec: (rec[0], tokenize(rec[1])))\n\ndef countTokens(vendorRDD):\n    \"\"\" Count and return the number of tokens\n    Args:\n        vendorRDD (RDD of (recordId, tokenizedValue)): Pair tuple of record ID to tokenized output\n    Returns:\n        count: count of all tokens\n    \"\"\"\n    return vendorRDD.flatMap(lambda (id, tokens): tokens).count()\n\ntotalTokens = countTokens(amazonRecToToken) + countTokens(googleRecToToken)\nprint 'There are %s tokens in the combined datasets' % totalTokens","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">There are 22520 tokens in the combined datasets\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.470072589903E12,"submitTime":1.470072581388E12,"finishTime":1.470072590127E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"d4b7ab46-711d-4bf3-bde9-3045294e29cf"},{"version":"CommandV1","origId":2632367762420766,"guid":"16dd1511-5a98-441c-964d-95a94520823e","subtype":"command","commandType":"auto","position":22.0,"command":"# TEST Tokenizing the small datasets (1c)\nTest.assertEquals(totalTokens, 22520, 'incorrect totalTokens')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.470072590133E12,"submitTime":1.470072581413E12,"finishTime":1.470072590206E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"5957e897-db13-4b33-85e7-a28a0bcab047"},{"version":"CommandV1","origId":2632367762420767,"guid":"ef5ff719-f1af-431a-9e91-bea2bc55ebb7","subtype":"command","commandType":"auto","position":23.0,"command":"%md\n#### **(1d) Amazon record with the most tokens**\nWhich Amazon record has the biggest number of tokens?\nIn other words, you want to sort the records and get the one with the largest count of tokens.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.470072581437E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"c1bdbb3b-96d9-47c9-ab5c-849ce2620bf0"},{"version":"CommandV1","origId":2632367762420768,"guid":"38c5aa0d-7364-4efc-8c8a-c6ebd64eea6a","subtype":"command","commandType":"auto","position":24.0,"command":"# TODO: Replace <FILL IN> with appropriate code\ndef findBiggestRecord(vendorRDD):\n    \"\"\" Find and return the record with the largest number of tokens\n    Args:\n        vendorRDD (RDD of (recordId, tokens)): input Pair Tuple of record ID and tokens\n    Returns:\n        list: a list of 1 Pair Tuple of record ID and tokens\n    \"\"\"\n    return vendorRDD.sortBy(lambda (id, tokens): -len(tokens)).take(1)\n\nbiggestRecordAmazon = findBiggestRecord(amazonRecToToken)\nprint 'The Amazon record with ID \"%s\" has the most tokens (%s)' % (biggestRecordAmazon[0][0],\n                                                                   len(biggestRecordAmazon[0][1]))","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">The Amazon record with ID &quot;b000o24l3q&quot; has the most tokens (1547)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.470072590213E12,"submitTime":1.470072581474E12,"finishTime":1.470072590636E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"559b8372-910a-44c9-8a7c-b5b2b3fcf711"},{"version":"CommandV1","origId":2632367762420769,"guid":"215b3193-e286-4456-a792-b3eb87fae20b","subtype":"command","commandType":"auto","position":25.0,"command":"# TEST Amazon record with the most tokens (1d)\nTest.assertEquals(biggestRecordAmazon[0][0], 'b000o24l3q', 'incorrect biggestRecordAmazon')\nTest.assertEquals(len(biggestRecordAmazon[0][1]), 1547, 'incorrect len for biggestRecordAmazon')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;biggestRecordAmazon&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-14-753bf28003e2&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> <span class=\"ansired\"># TEST Amazon record with the most tokens (1d)</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>Test<span class=\"ansiyellow\">.</span>assertEquals<span class=\"ansiyellow\">(</span>biggestRecordAmazon<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&apos;b000o24l3q&apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&apos;incorrect biggestRecordAmazon&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      3</span> Test<span class=\"ansiyellow\">.</span>assertEquals<span class=\"ansiyellow\">(</span>len<span class=\"ansiyellow\">(</span>biggestRecordAmazon<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1547</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&apos;incorrect len for biggestRecordAmazon&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;biggestRecordAmazon&apos; is not defined\n</div>","workflows":[],"startTime":1.470072590645E12,"submitTime":1.470072581499E12,"finishTime":1.470072590684E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"f6f66501-0f7a-43dc-86cf-c3e5267b247a"},{"version":"CommandV1","origId":2632367762420770,"guid":"c562ac55-d4fc-4a1e-9fe4-47ec2549bbd0","subtype":"command","commandType":"auto","position":26.0,"command":"%md\n#### **Part 2: ER as Text Similarity - Weighted Bag-of-Words using TF-IDF**\nBag-of-words comparisons are not very good when all tokens are treated the same: some tokens are more important than others. Weights give us a way to specify which tokens to favor. With weights, when we compare documents, instead of counting common tokens, we sum up the weights of common tokens. A good heuristic for assigning weights is called \"Term-Frequency/Inverse-Document-Frequency,\" or [TF-IDF][tfidf] for short.\n \n**TF**\n \nTF rewards tokens that appear many times in the same document. It is computed as the frequency of a token in a document, that is, if document *d* contains 100 tokens and token *t* appears in *d* 5 times, then the TF weight of *t* in *d* is *5/100 = 1/20*. The intuition for TF is that if a word occurs often in a document, then it is more important to the meaning of the document.\n \n**IDF**\n \nIDF rewards tokens that are rare overall in a dataset. The intuition is that it is more significant if two documents share a rare word than a common one. IDF weight for a token, *t*, in a set of documents, *U*, is computed as follows:\n* Let *N* be the total number of documents in *U*\n* Find *n(t)*, the number of documents in *U* that contain *t*\n* Then *IDF(t) = N/n(t)*.\n \nNote that *n(t)/N* is the frequency of *t* in *U*, and *N/n(t)* is the inverse frequency.\n \n> **Note on terminology**: Sometimes token weights depend on the document the token belongs to, that is, the same token may have a different weight when it's found in different documents.  We call these weights *local* weights.  TF is an example of a local weight, because it depends on the length of the source.  On the other hand, some token weights only depend on the token, and are the same everywhere that token is found.  We call these weights *global*, and IDF is one such weight.\n \n**TF-IDF**\n \nFinally, to bring it all together, the total TF-IDF weight for a token in a document is the product of its TF and IDF weights.\n[tfidf]: https://en.wikipedia.org/wiki/Tf%E2%80%93idf","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.470072581522E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"b5448b80-0a2f-47fe-8dac-b6135aebe2cb"},{"version":"CommandV1","origId":2632367762420771,"guid":"c098ad4f-5240-489d-9dfc-13e3b6f11afb","subtype":"command","commandType":"auto","position":27.0,"command":"%md\n#### **(2a) Implement a TF function**\n \nImplement `tf(tokens)` that takes a list of tokens and returns a Python [dictionary](https://docs.python.org/2/tutorial/datastructures.html#dictionaries) mapping tokens to TF weights.\n \nThe steps your function should perform are:\n* Create an empty Python dictionary\n* For each of the tokens in the input `tokens` list, count 1 for each occurance and add the token to the dictionary\n* For each of the tokens in the dictionary, divide the token's count by the total number of tokens in the input `tokens` list","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.470072581553E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"31b9941e-3bc6-4880-aff7-b54362c46f97"},{"version":"CommandV1","origId":2632367762420772,"guid":"ff9012ed-cbec-40b3-abe0-36f977244678","subtype":"command","commandType":"auto","position":28.0,"command":"# TODO: Replace <FILL IN> with appropriate code\ndef tf(tokens):\n    \"\"\" Compute TF\n    Args:\n        tokens (list of str): input list of tokens from tokenize\n    Returns:\n        dictionary: a dictionary of tokens to its TF values\n    \"\"\"\n    \n    # Create an empty Python dictionary\n    tf_dict = {}\n    \n    # For each of the tokens in the input tokens list, count 1 for each occurance and add the token to the dictionary\n    for token in tokens:\n        if token in tf_dict:\n            tf_dict[token] += 1\n        else:\n            tf_dict[token] = 1\n    \n    # For each of the tokens in the dictionary, divide the token's count by the total number of tokens in the input tokens list\n    tf_normalized = {}\n    N = len(tokens)\n    for key in tf_dict.keys():\n        tf_normalized[key] = float(tf_dict[key]) / N\n        \n    return tf_normalized\n  \nprint tf(tokenize(quickbrownfox)) # Should give { 'quick': 0.1666 ... }\n","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">{&apos;brown&apos;: 0.16666666666666666, &apos;lazy&apos;: 0.16666666666666666, &apos;jumps&apos;: 0.16666666666666666, &apos;fox&apos;: 0.16666666666666666, &apos;dog&apos;: 0.16666666666666666, &apos;quick&apos;: 0.16666666666666666}\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.47007259069E12,"submitTime":1.470072581584E12,"finishTime":1.470072590736E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"ab9fe85b-911e-40dc-914c-12ee3f2bc90d"},{"version":"CommandV1","origId":2632367762420773,"guid":"ceabb5b0-072b-4276-ad67-1b5b6d3c1872","subtype":"command","commandType":"auto","position":29.0,"command":"# TEST Implement a TF function (2a)\ntf_test = tf(tokenize(quickbrownfox))\nTest.assertEquals(tf_test, {'brown': 0.16666666666666666, 'lazy': 0.16666666666666666,\n                             'jumps': 0.16666666666666666, 'fox': 0.16666666666666666,\n                             'dog': 0.16666666666666666, 'quick': 0.16666666666666666},\n                    'incorrect result for tf on sample text')\ntf_test2 = tf(tokenize('one_ one_ two!'))\nTest.assertEquals(tf_test2, {'one_': 0.6666666666666666, 'two': 0.3333333333333333},\n                    'incorrect result for tf test')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.470072590742E12,"submitTime":1.470072581607E12,"finishTime":1.470072590817E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"73a6d98a-5e53-4980-991c-bca1c19dca7d"},{"version":"CommandV1","origId":2632367762420774,"guid":"a1dcdc21-3aef-477f-9e21-2e66b0752ea4","subtype":"command","commandType":"auto","position":30.0,"command":"%md\n#### **(2b) Create a corpus**\nCreate a pair RDD called `corpusRDD`, consisting of a combination of the two small datasets, `amazonRecToToken` and `googleRecToToken`. Each element of the `corpusRDD` should be a pair consisting of a key from one of the small datasets (ID or URL) and the value is the associated value for that key from the small datasets.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.470072581631E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"b1585939-858e-4bfd-9400-71eaa77579c8"},{"version":"CommandV1","origId":2632367762420775,"guid":"5573ba08-4fee-40c3-98fd-541f9d9f5f81","subtype":"command","commandType":"auto","position":31.0,"command":"# TODO: Replace <FILL IN> with appropriate code\ncorpusRDD = amazonRecToToken + googleRecToToken","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.470072590822E12,"submitTime":1.470072581668E12,"finishTime":1.470072590894E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"153ab1b2-811e-4ba1-be86-96985017b31f"},{"version":"CommandV1","origId":2632367762420776,"guid":"2a4c6bc3-5a22-4c83-97d4-e17cbe216f21","subtype":"command","commandType":"auto","position":32.0,"command":"# TEST Create a corpus (2b)\nTest.assertEquals(corpusRDD.count(), 400, 'incorrect corpusRDD.count()')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.470072590907E12,"submitTime":1.470072581692E12,"finishTime":1.470072591081E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"b92a91bd-ee2d-45cf-b18a-d6f7ee706d08"},{"version":"CommandV1","origId":2632367762420777,"guid":"e91bb1c1-2100-423e-8864-ed1741173a6d","subtype":"command","commandType":"auto","position":33.0,"command":"%md\n#### **(2c) Implement an IDFs function**\nImplement `idfs` that assigns an IDF weight to every unique token in an RDD called `corpus`. The function should return an pair RDD where the `key` is the unique token and value is the IDF weight for the token.\n \nRecall that the IDF weight for a token, *t*, in a set of documents, *U*, is computed as follows:\n* Let *N* be the total number of documents in *U*.\n* Find *n(t)*, the number of documents in *U* that contain *t*.\n* Then *IDF(t) = N/n(t)*.\n \nThe steps your function should perform are:\n* Calculate *N*. Think about how you can calculate *N* from the input RDD.\n* Create an RDD (*not a pair RDD*) containing the unique tokens from each document in the input `corpus`. For each document, you should only include a token once, *even if it appears multiple times in that document.*\n* For each of the unique tokens, count how many times it appears in the document and then compute the IDF for that token: *N/n(t)*\n \nUse your `idfs` to compute the IDF weights for all tokens in `corpusRDD` (the combined small datasets).\nHow many unique tokens are there?","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.470072581718E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"b7f2077a-e97b-4066-937c-94a4f97e9cdf"},{"version":"CommandV1","origId":2632367762420778,"guid":"d29208ee-2c0c-4288-8422-e8f2d0f96bd6","subtype":"command","commandType":"auto","position":34.0,"command":"# TODO: Replace <FILL IN> with appropriate code\ndef idfs(corpus):\n    \"\"\" Compute IDF\n    Args:\n        corpus (RDD): input corpus\n    Returns:\n        RDD: a RDD of (token, IDF value)\n    \"\"\"\n    # The total number of documents in U\n    N = corpus.map(lambda doc: doc[0]).distinct().count()\n    \n    # n(t), the number of documents in U that contain t\n    uniqueTokens = corpus.flatMap(lambda doc: list(set(doc[1])))\n    tokenCountPairTuple = uniqueTokens.map(lambda token: (token,1))\n    tokenSumPairTuple = tokenCountPairTuple.reduceByKey(lambda a,b: a+b)\n    return (tokenSumPairTuple.map(lambda (token, count): (token, 1.* N / count)))\n\nidfsSmall = idfs(amazonRecToToken.union(googleRecToToken))\nuniqueTokenCount = idfsSmall.count()\n\nprint 'There are %s unique tokens in the small datasets.' % uniqueTokenCount","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">There are 4772 unique tokens in the small datasets.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.47007259109E12,"submitTime":1.470072581749E12,"finishTime":1.470072591665E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"f614d94c-2d9e-4c83-beda-7acd366fecc9"},{"version":"CommandV1","origId":2632367762420779,"guid":"0cd26ca0-c390-4f8d-89b7-fb678e0b0504","subtype":"command","commandType":"auto","position":35.0,"command":"# TEST Implement an IDFs function (2c)\nTest.assertEquals(uniqueTokenCount, 4772, 'incorrect uniqueTokenCount')\ntokenSmallestIdf = idfsSmall.takeOrdered(1, lambda s: s[1])[0]\nTest.assertEquals(tokenSmallestIdf[0], 'software', 'incorrect smallest IDF token')\nTest.assertTrue(abs(tokenSmallestIdf[1] - 4.25531914894) < 0.0000000001,\n                'incorrect smallest IDF value')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.470072591671E12,"submitTime":1.470072581772E12,"finishTime":1.470072591847E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"f13b13dc-1114-4af2-b854-6374b5b2d47a"},{"version":"CommandV1","origId":2632367762420780,"guid":"36891a7f-6a5e-493e-9a54-fab8bb69e43e","subtype":"command","commandType":"auto","position":36.0,"command":"%md\n#### **(2d) Tokens with the smallest IDF**\nPrint out the 11 tokens with the smallest IDF in the combined small dataset.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.470072581795E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"487f42e5-b6c7-4257-bcc8-0dff6df71b08"},{"version":"CommandV1","origId":2632367762420781,"guid":"431b62a2-2137-432a-be88-fcccd8045acd","subtype":"command","commandType":"auto","position":37.0,"command":"smallIDFTokens = idfsSmall.takeOrdered(11, lambda s: s[1])\nprint smallIDFTokens","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">[(&apos;software&apos;, 4.25531914893617), (&apos;new&apos;, 6.896551724137931), (&apos;features&apos;, 6.896551724137931), (&apos;use&apos;, 7.017543859649122), (&apos;complete&apos;, 7.2727272727272725), (&apos;easy&apos;, 7.6923076923076925), (&apos;create&apos;, 8.333333333333334), (&apos;system&apos;, 8.333333333333334), (&apos;cd&apos;, 8.333333333333334), (&apos;1&apos;, 8.51063829787234), (&apos;windows&apos;, 8.51063829787234)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.470072591853E12,"submitTime":1.470072581829E12,"finishTime":1.470072591975E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"16143997-6588-4833-9c8e-1c3c3bfbb1f5"},{"version":"CommandV1","origId":2632367762420782,"guid":"8a675c80-df97-4ae4-94ed-15095d6a8bfd","subtype":"command","commandType":"auto","position":38.0,"command":"%md\n#### **(2e) IDF Histogram**\nPlot a histogram of IDF values.  Be sure to use appropriate scaling and bucketing for the data.\nFirst plot the histogram using `matplotlib`","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.470072581857E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"1ea6bb7c-0820-43b7-b490-3b809b00d238"},{"version":"CommandV1","origId":2632367762420783,"guid":"a5202dd3-dead-4a48-b2a9-0c5037c88ac1","subtype":"command","commandType":"auto","position":39.0,"command":"import matplotlib.pyplot as plt\n\nsmall_idf_values = idfsSmall.map(lambda s: s[1]).collect()\nfig = plt.figure(figsize=(8,3))\nplt.hist(small_idf_values, 50, log=True)\ndisplay(fig) \npass","commandVersion":1,"state":"finished","results":{"type":"image","data":"data:image/png;base64,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","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.470072591981E12,"submitTime":1.47007258189E12,"finishTime":1.470072594493E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"5ed43734-ff66-4f86-8096-6c3c8cd0aff3"},{"version":"CommandV1","origId":2632367762420784,"guid":"99b2cba6-10c7-43f0-9e2f-e35cb9e7b301","subtype":"command","commandType":"auto","position":40.0,"command":"from pyspark.sql import Row\n\n# Create a DataFrame and visualize using display()\nidfsToCountRow = idfsSmall.map(lambda (x, y): Row(token=x, value=y))\nidfsToCountDF = sqlContext.createDataFrame(idfsToCountRow)\ndisplay(idfsToCountDF)","commandVersion":1,"state":"finished","results":{"type":"table","data":[["aided",400.0],["precise",100.0],["duplex",400.0],["dance",400.0],["breath",200.0],["themes",133.33333333333334],["known",100.0],["verses",400.0],["battle",100.0],["9999",400.0],["targeted",400.0],["layers",100.0],["content",23.529411764705884],["xml",400.0],["paris",400.0],["volume",80.0],["environment",44.44444444444444],["german",400.0],["wants",400.0],["diskcromwindows",400.0],["antique",200.0],["nightfall",400.0],["merchant",400.0],["shoot",400.0],["infinite",400.0],["lessons",44.44444444444444],["far",133.33333333333334],["puzzles",100.0],["downsample",400.0],["elona",400.0],["telling",200.0],["em",200.0],["tri",200.0],["enjoyable",400.0],["788687400220",400.0],["customizable",66.66666666666667],["large",57.142857142857146],["hexachrome",400.0],["phase",400.0],["melodies",200.0],["fractions",200.0],["enjoy",44.44444444444444],["visuals",400.0],["madcap",400.0],["synergy",200.0],["talks",200.0],["go",80.0],["licenses",57.142857142857146],["universities",200.0],["trhough",400.0],["cell",200.0],["deleted",400.0],["templates",57.142857142857146],["sims",400.0],["certificates",400.0],["authoritative",400.0],["body",80.0],["compact",80.0],["relationships",200.0],["ambience",400.0],["zoology",400.0],["hours",33.333333333333336],["growing",200.0],["esk9",400.0],["directions",400.0],["box",66.66666666666667],["cockpit",400.0],["almost",133.33333333333334],["sharks",400.0],["institute",400.0],["current",133.33333333333334],["museums",200.0],["tv",200.0],["action",33.333333333333336],["camerata",400.0],["giftseven",400.0],["beautiful",66.66666666666667],["inbound",400.0],["extrn",400.0],["informatics",400.0],["landdesigner",400.0],["300mhz",400.0],["eg04025",400.0],["psat",133.33333333333334],["mappoint",400.0],["files",14.285714285714286],["receivable",400.0],["buttons",200.0],["browse",400.0],["connector",400.0],["process",40.0],["sample",100.0],["encode",400.0],["breakthrough",400.0],["sort",133.33333333333334],["shine",400.0],["immersion",50.0],["entsec",400.0],["equivalents",400.0],["std",200.0],["timecode",400.0],["fly",200.0],["high",16.0],["truetype",400.0],["languages",100.0],["tunnel",200.0],["past",100.0],["pr",400.0],["reviews",400.0],["instantaneously",400.0],["regions",400.0],["following",100.0],["chapter",400.0],["control",33.333333333333336],["multistore",200.0],["habitats",200.0],["invoices",200.0],["10307",400.0],["topic",400.0],["claimed",400.0],["authorities",400.0],["stationery",200.0],["scheduling",200.0],["simple",22.22222222222222],["creates",133.33333333333334],["answer",200.0],["trailers",400.0],["steve",200.0],["rather",200.0],["club",200.0],["machine",200.0],["mpn",80.0],["shortcuts",400.0],["astronomers",400.0],["perimeter",400.0],["pins",400.0],["precisiondrawings",400.0],["profile",400.0],["building",100.0],["specifications",400.0],["soundtrack",200.0],["director",200.0],["discovering",400.0],["date",50.0],["geared",400.0],["02322",400.0],["950000",400.0],["status",400.0],["watercolor",200.0],["four",66.66666666666667],["postfix",400.0],["tale",200.0],["provide",33.333333333333336],["mermaids",400.0],["interior",400.0],["sc",400.0],["increase",66.66666666666667],["biographies",400.0],["operations",80.0],["exotic",133.33333333333334],["circulatory",400.0],["react",200.0],["hierarchy",400.0],["symbols",400.0],["dv",133.33333333333334],["netw",400.0],["24",57.142857142857146],["delay",400.0],["personal",20.0],["defends",400.0],["better",30.76923076923077],["feel",400.0],["policy",80.0],["release",133.33333333333334],["versus",400.0],["harmful",400.0],["food",400.0],["complements",400.0],["scaling",400.0],["inch",100.0],["front",200.0],["shadows",400.0],["ue",400.0],["modp",400.0],["edit",36.36363636363637],["possibilities",80.0],["skills",18.181818181818183],["ints3",400.0],["shores",400.0],["crossing",400.0],["sketches",200.0],["wheel",100.0],["metrics",400.0],["jones",400.0],["navi",400.0],["universalis",400.0],["challenges",80.0],["frames",100.0],["loops",400.0],["bosendorfer",400.0],["album",400.0],["leave",200.0],["mickey",400.0],["zetafax",400.0],["velociraptor",400.0],["blu",200.0],["jump",133.33333333333334],["toolbars",400.0],["emulate",400.0],["adv",200.0],["print",21.05263157894737],["fun",20.0],["eco",400.0],["pleasant",400.0],["small",36.36363636363637],["included",57.142857142857146],["carb",200.0],["wall",400.0],["revolutionary",400.0],["driven",400.0],["reinforces",400.0],["put",133.33333333333334],["motion",66.66666666666667],["introduction",400.0],["corrector",400.0],["distinguish",400.0],["oper",400.0],["info",400.0],["grade",100.0],["diana",400.0],["imagemanager",400.0],["aggregate",400.0],["plants",400.0],["preparation",200.0],["carry",200.0],["aperture",400.0],["sensiive",400.0],["1a",400.0],["bonus",133.33333333333334],["subnetworks",200.0],["europe",200.0],["anyone",66.66666666666667],["nbs",400.0],["exhilarating",400.0],["trend",400.0],["clicking",400.0],["filter",400.0],["arthate",400.0],["1999",400.0],["rolling",400.0],["synthetic",400.0],["cocktails",100.0],["60",133.33333333333334],["pb",400.0],["broadcast",400.0],["notices",400.0],["cook",400.0],["push",400.0],["refund",400.0],["fats",400.0],["pristine",200.0],["customer",133.33333333333334],["11",40.0],["connections",200.0],["datawatch",400.0],["travels",400.0],["softgrid",400.0],["keeper",400.0],["spending",400.0],["recording",133.33333333333334],["cards",36.36363636363637],["states",400.0],["notecards",133.33333333333334],["viva",200.0],["pre",50.0],["hotspots",200.0],["viewer",400.0],["textures",133.33333333333334],["enabling",400.0],["uniquely",400.0],["oracle",400.0],["wysiwyg",200.0],["download",200.0],["sypware",400.0],["need",10.526315789473685],["facing",200.0],["sell",400.0],["printshop",100.0],["presents",50.0],["efficient",57.142857142857146],["note",133.33333333333334],["hr",400.0],["transmit",400.0],["2d",200.0],["folders",100.0],["even",14.285714285714286],["printable",66.66666666666667],["satisfy",400.0],["depths",400.0],["furious",400.0],["itandquot",400.0],["mansion",400.0],["device",100.0],["acquired",400.0],["nonprofits",200.0],["wireless",100.0],["resident",400.0],["5u",400.0],["mobile",66.66666666666667],["traditional",133.33333333333334],["giving",100.0],["keywords",400.0],["sierra",200.0],["caching",400.0],["majestic",200.0],["shop",57.142857142857146],["erasing",400.0],["lotus",400.0],["administrators",133.33333333333334],["russian",400.0],["decorative",400.0],["stateful",400.0],["dorothy",400.0],["impact",200.0],["rerecord",400.0],["tier",400.0],["charges",400.0],["mysterious",200.0],["implementation",133.33333333333334],["terminal",400.0],["textbridge",133.33333333333334],["dodge",400.0],["count",133.33333333333334],["predict",400.0],["quizzes",400.0],["libraries",400.0],["installs",200.0],["pocket",400.0],["illustrations",80.0],["report",100.0],["indragon",400.0],["intensive",400.0],["intego",400.0],["equisys",400.0],["rfc",400.0],["19",400.0],["intervened",400.0],["gulch",400.0],["exercises",200.0],["employee",200.0],["analytical",400.0],["remains",400.0],["00320289",400.0],["preserve",200.0],["nfsv4",400.0],["authorize",400.0],["detection",400.0],["facts",400.0],["overstocking",400.0],["closer",200.0],["planet",200.0],["knowing",400.0],["ways",50.0],["weapons",400.0],["case",33.333333333333336],["integrate",400.0],["novastor",400.0],["affordable",80.0],["perfect",40.0],["tricky",400.0],["128",57.142857142857146],["guitar",28.571428571428573],["dts",400.0],["consists",400.0],["interface",18.181818181818183],["separately",133.33333333333334],["professionalto",400.0],["admin",200.0],["tlc",400.0],["legion",400.0],["objective",400.0],["swim",400.0],["corrupt",400.0],["load",200.0],["detailed",100.0],["color",21.05263157894737],["geometry",400.0],["offerings",200.0],["apache",400.0],["h32",400.0],["wider",200.0],["platinum",133.33333333333334],["forms",36.36363636363637],["leads",400.0],["addition",57.142857142857146],["twain",400.0],["ai",200.0],["tutorials",200.0],["garageband",400.0],["dots",400.0],["donating",400.0],["tedium",400.0],["ghost",400.0],["fire",66.66666666666667],["laptops",133.33333333333334],["gms",133.33333333333334],["atlas",400.0],["immersive",400.0],["quick",80.0],["sound",50.0],["carbohydrate",400.0],["solid",133.33333333333334],["vrs",400.0],["multilayer",400.0],["rope",200.0],["technical",133.33333333333334],["bsendorfer",400.0],["win32",200.0],["campaigns",400.0],["setuid",400.0],["1094",400.0],["vol",400.0],["standby",400.0],["ii",80.0],["ready",50.0],["feed",400.0],["cmyk",400.0],["edr",400.0],["perform",57.142857142857146],["roar",400.0],["member",400.0],["rules",133.33333333333334],["9",44.44444444444444],["complexities",400.0],["development",30.76923076923077],["efx",400.0],["calculation",400.0],["keys",133.33333333333334],["blue",200.0],["producers",400.0],["heterogeneous",400.0],["helped",200.0],["haunting",200.0],["audit",400.0],["commemorate",400.0],["maestro",400.0],["minimize",400.0],["county",400.0],["thought",133.33333333333334],["mia",133.33333333333334],["1",8.51063829787234],["services",30.76923076923077],["coordinate",400.0],["wrangling",400.0],["seasonal",200.0],["lowers",200.0],["moments",200.0],["reproductions",400.0],["engine",100.0],["myinvoices",400.0],["govt",133.33333333333334],["fogware",200.0],["llc",400.0],["touch",400.0],["hacker",400.0],["taken",400.0],["letting",400.0],["kaufman",400.0],["beginners",200.0],["indu",400.0],["enthusiast",400.0],["thinking",133.33333333333334],["300",133.33333333333334],["signals",400.0],["firewall",100.0],["512mb",400.0],["snap",80.0],["throne",400.0],["fontware",400.0],["styles",100.0],["mystery",133.33333333333334],["read",80.0],["successful",200.0],["early",80.0],["finding",400.0],["press",100.0],["individually",400.0],["usually",100.0],["xsr",400.0],["brought",400.0],["satisfaction",400.0],["postcard",200.0],["pet",200.0],["specific",66.66666666666667],["turbocad",200.0],["popular",44.44444444444444],["millies",400.0],["healthy",400.0],["accessible",133.33333333333334],["node",133.33333333333334],["firebox",400.0],["sends",400.0],["prototyping",400.0],["cs",400.0],["cd374",400.0],["images",33.333333333333336],["happens",400.0],["shapes",133.33333333333334],["thrilled",400.0],["gamecard",400.0],["broadband",400.0],["absolutely",400.0],["multiplication",400.0],["witty",400.0],["customize",66.66666666666667],["00034",400.0],["capability",200.0],["locate",200.0],["erased",400.0],["seconds",133.33333333333334],["26162",400.0],["respected",400.0],["passive",400.0],["assemble",400.0],["oversee",400.0],["plug",100.0],["anatomy",200.0],["gifts",400.0],["attacks",80.0],["compatible",44.44444444444444],["monthly",400.0],["favourite",400.0],["warranty",133.33333333333334],["uncompromised",400.0],["real",23.529411764705884],["roofs",400.0],["administer",400.0],["variable",133.33333333333334],["elementary",200.0],["sized",200.0],["managing",100.0],["wherabouts",400.0],["interactivity",200.0],["espro",400.0],["artifacts",133.33333333333334],["available",33.333333333333336],["column",400.0],["generation",200.0],["biggest",200.0],["krupa",400.0],["function",57.142857142857146],["project",30.76923076923077],["120",400.0],["opt",400.0],["delivery",133.33333333333334],["films",200.0],["cs3k",400.0],["active",100.0],["oxford",133.33333333333334],["freddi",133.33333333333334],["engaging",133.33333333333334],["whether",26.666666666666668],["access",20.0],["clips",80.0],["windows",8.51063829787234],["oom",80.0],["retaining",200.0],["continuously",400.0],["diagnose",400.0],["website",400.0],["units",200.0],["taste",200.0],["globally",400.0],["substantially",400.0],["kingdom",400.0],["importing",400.0],["decipher",400.0],["phantom",400.0],["acceleration",400.0],["improving",400.0],["pz24a0075",400.0],["water",133.33333333333334],["preventing",400.0],["started",200.0],["1788",400.0],["test",57.142857142857146],["ruthless",200.0],["scored",400.0],["category",200.0],["may",50.0],["students",33.333333333333336],["packaging",400.0],["helping",133.33333333333334],["town",100.0],["hardware",100.0],["track",57.142857142857146],["absorbing",400.0],["jvc",400.0],["soundblaster",400.0],["timing",400.0],["livesecurity",400.0],["searches",200.0],["assume",400.0],["backed",80.0],["2002",133.33333333333334],["frees",200.0],["write",133.33333333333334],["week",400.0],["directory",200.0],["receive",133.33333333333334],["limited",100.0],["positions",400.0],["battlefields",400.0],["breadth",400.0],["caused",400.0],["recapturing",400.0],["resisted",400.0],["follow",44.44444444444444],["conversation",400.0],["equipment",200.0],["everything",28.571428571428573],["pedalling",400.0],["april",400.0],["8ghz",400.0],["james",400.0],["0",8.695652173913043],["scratch",100.0],["suite",14.814814814814815],["activities",25.0],["hdv",200.0],["wayfarers",400.0],["removing",400.0],["pbupgrd",400.0],["heard",200.0],["replication",400.0],["literally",200.0],["formula",400.0],["affect",200.0],["entire",44.44444444444444],["desserts",400.0],["turns",200.0],["ax",400.0],["item",400.0],["progress",100.0],["car",400.0],["enhance",80.0],["entourage",400.0],["eagle",200.0],["phones",400.0],["among",400.0],["elegant",400.0],["subtle",400.0],["4x6",200.0],["assures",400.0],["requiring",400.0],["distiller",100.0],["essence",400.0],["sun",133.33333333333334],["suv",400.0],["gaming",400.0],["booklet",200.0],["international",133.33333333333334],["supporting",400.0],["partners",66.66666666666667],["radicals",400.0],["velocity",400.0],["web",14.285714285714286],["making",80.0],["sing",133.33333333333334],["1024",133.33333333333334],["shared",400.0],["publisher",66.66666666666667],["canuse",400.0],["division",400.0],["iphoto",400.0],["32",100.0],["optimal",400.0],["640",400.0],["readiris",400.0],["installer",400.0],["500mb",400.0],["military",200.0],["as400",400.0],["purchases",400.0],["win",8.88888888888889],["v22",200.0],["visualization",400.0],["newsfeeds",400.0],["unpredictable",400.0],["apply",100.0],["intranet",400.0],["graphs",400.0],["interpretair",200.0],["positive",400.0],["h",200.0],["scope",400.0],["sexy",400.0],["los",400.0],["charcoal",200.0],["definition",133.33333333333334],["micro",200.0],["oscar",200.0],["synchronize",200.0],["phone",133.33333333333334],["bellarion",400.0],["teaching",66.66666666666667],["90",133.33333333333334],["flawless",400.0],["150",133.33333333333334],["organizations",50.0],["frequently",400.0],["drawer",400.0],["ed",200.0],["science",66.66666666666667],["strain",200.0],["movies",66.66666666666667],["intranets",400.0],["webster",400.0],["spy",133.33333333333334],["1pk",400.0],["laurence",400.0],["kobe",400.0],["synchronizes",200.0],["mayhem",400.0],["phrase",200.0],["icopydvds2",133.33333333333334],["information",12.5],["coursewarecustomizing",400.0],["turn",28.571428571428573],["softwaretools",400.0],["640x480",200.0],["familiar",100.0],["cd08393wi",400.0],["arswaargh",400.0],["3des",400.0],["bags",400.0],["broad",133.33333333333334],["dinosaurs",200.0],["independent",200.0],["portfolio",400.0],["records",200.0],["guesswork",200.0],["jumpstart",80.0],["fleet",400.0],["purchase",80.0],["organization",80.0],["famous",200.0],["skeletal",400.0],["light",133.33333333333334],["dramatica",200.0],["introducing",400.0],["webroot",200.0],["cannon",400.0],["things",80.0],["solos",200.0],["firehouse",400.0],["exclusive",133.33333333333334],["clubhouse",400.0],["developed",100.0],["kyoto",400.0],["course",133.33333333333334],["sony",133.33333333333334],["captions",200.0],["adhesive",400.0],["position",400.0],["scrapbook",400.0],["maps",400.0],["pcs",100.0],["platform",44.44444444444444],["tiff",400.0],["mail",50.0],["freely",400.0],["endor",400.0],["flex",200.0],["smarter",400.0],["band",133.33333333333334],["party",80.0],["dealing",400.0],["environmental",400.0],["easily",15.384615384615385],["fantasy",200.0],["wrkgrp",400.0],["lifetime",400.0],["realistic",100.0],["25",200.0],["upg",33.333333333333336],["upsell",400.0],["mercy",400.0],["improvise",400.0],["meets",200.0],["series",50.0],["society",400.0],["thoughtfully",200.0],["logo",200.0],["brings",66.66666666666667],["living",133.33333333333334],["sha",400.0],["culture",400.0],["god",200.0],["re",21.05263157894737],["3gp",400.0],["got",66.66666666666667],["strategies",80.0],["foundation",200.0],["found",200.0],["timeline",200.0],["garnishes",400.0],["binary",400.0],["houses",400.0],["uncover",400.0],["poems",400.0],["r5",400.0],["sp1",100.0],["applications",17.391304347826086],["lfl",400.0],["phrases",200.0],["pictures",66.66666666666667],["confident",400.0],["todayandquot",400.0],["thing",133.33333333333334],["person",400.0],["leading",40.0],["timelines",133.33333333333334],["gif",400.0],["ste",400.0],["flood",400.0],["kernel",200.0],["dungeons",400.0],["intuitively",400.0],["acoustic",400.0],["fi",400.0],["csdc",133.33333333333334],["loaded",200.0],["ferris",200.0],["unknown",200.0],["player",66.66666666666667],["needed",100.0],["flashcards",400.0],["toolset",133.33333333333334],["west",400.0],["enforcement",200.0],["corporations",400.0],["collectible",400.0],["1419",400.0],["wav",400.0],["x3",200.0],["wide",57.142857142857146],["quantitative",400.0],["installers",200.0],["r3900292",400.0],["prevent",133.33333333333334],["double",200.0],["players",57.142857142857146],["thinkyou",400.0],["country",200.0],["bridge",100.0],["hijackers",400.0],["exploring",400.0],["portraits",400.0],["98",22.22222222222222],["raw",133.33333333333334],["close",400.0],["portrait",400.0],["seen",400.0],["ratings",400.0],["patterns",400.0],["convenient",66.66666666666667],["mix",57.142857142857146],["articles",200.0],["commissions",400.0],["superior",100.0],["floods",400.0],["communications",26.666666666666668],["200",100.0],["headset",400.0],["quote",200.0],["thoroughly",400.0],["simplify",400.0],["x",12.903225806451612],["photofinishing",400.0],["comparison",200.0],["mypc",400.0],["menus",66.66666666666667],["studyworks",400.0],["doc",400.0],["riddled",400.0],["fat16",400.0],["itempowers",400.0],["occasion",200.0],["imaginative",400.0],["incorporate",200.0],["roleplaying",400.0],["pamphlets",200.0],["orleans",400.0],["gates",400.0],["withstand",400.0],["text",25.0],["league",200.0],["bring",33.333333333333336],["babwbr1151s05",400.0],["earth",400.0],["sleuths",200.0],["favor",200.0],["menu",400.0],["darklords",400.0],["cultures",400.0],["entities",200.0],["simplicity",400.0],["solitary",400.0],["gods",100.0],["8",18.181818181818183],["x3mac",400.0],["loved",400.0],["ip",400.0],["loss",400.0],["dvds",28.571428571428573],["professionals",50.0],["assistant",400.0],["postscript",200.0],["20033",400.0],["p",200.0],["ssl",400.0],["xvid",200.0],["fingerpicking",200.0],["cuisine",200.0],["pk",133.33333333333334],["reveal",400.0],["ended",400.0],["fields",100.0],["crosspicking",400.0],["twice",400.0],["wish",133.33333333333334],["tuner",200.0],["mito",400.0],["characteristics",400.0],["enhances",400.0],["solo",200.0],["intelligence",133.33333333333334],["routers",200.0],["eidos",200.0],["edition",12.5],["equip",400.0],["b26",200.0],["collects",400.0],["pastel",133.33333333333334],["nis",400.0],["clickable",400.0],["eurotalk",400.0],["movie",44.44444444444444],["discounts",400.0],["joy",200.0],["import",36.36363636363637],["fs2004",400.0],["pkcs",400.0],["converting",400.0],["tables",133.33333333333334],["scanning",100.0],["comp",200.0],["prior",200.0],["efficiency",100.0],["invest",400.0],["highlight",400.0],["approval",400.0],["qual",400.0],["foes",400.0],["mob",400.0],["mcafee",400.0],["many",25.0],["forced",400.0],["0c",133.33333333333334],["retiming",400.0],["agile",400.0],["attributes",133.33333333333334],["affairs",200.0],["mini",200.0],["relational",400.0],["overview",22.22222222222222],["scrapbooks",200.0],["amazingly",200.0],["connectivity",80.0],["adding",200.0],["framework",100.0],["path",100.0],["table",400.0],["vrs4",400.0],["equips",400.0],["instrument",200.0],["encryption",100.0],["submarine",400.0],["imports",400.0],["linguistic",400.0],["rfc2054",400.0],["ethernet",400.0],["sending",400.0],["quantities",400.0],["downed",400.0],["new",6.896551724137931],["photos",26.666666666666668],["unified",200.0],["clusters",400.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"token","type":"\"string\""},{"name":"value","type":"\"double\""}],"overflow":true,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1.47007259452E12,"submitTime":1.470072581912E12,"finishTime":1.47007259509E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"ca90e285-d97c-4b07-85b5-49c44cbe4f33"},{"version":"CommandV1","origId":2632367762420785,"guid":"e2331a18-7721-48f8-a804-68ee0d1629a9","subtype":"command","commandType":"auto","position":41.0,"command":"%md\n#### **(2f) Implement a TF-IDF function**\nUse your `tf` function to implement a `tfidf(tokens, idfs)` function that takes a list of tokens from a document and a Python dictionary of IDF weights and returns a Python dictionary mapping individual tokens to total TF-IDF weights.\n \nThe steps your function should perform are:\n* Calculate the token frequencies (TF) for `tokens`\n* Create a Python dictionary where each token maps to the token's frequency times the token's IDF weight\n \nUse your `tfidf` function to compute the weights of Amazon product record 'b000hkgj8k'. To do this, we need to extract the record for the token from the tokenized small Amazon dataset and we need to convert the IDFs for the small dataset into a Python dictionary. We can do the first part, by using a `filter()` transformation to extract the matching record and a `collect()` action to return the value to the driver.\n \nFor the second part, we use the [`collectAsMap()` action](http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.collectAsMap) to return the IDFs to the driver as a Python dictionary.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.47007258194E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"b4552a9e-2117-4731-b410-e76b1ccb20c6"},{"version":"CommandV1","origId":2632367762420786,"guid":"5cd20707-630f-462c-b9d5-ad86847c4f3d","subtype":"command","commandType":"auto","position":42.0,"command":"# TODO: Replace <FILL IN> with appropriate code\ndef tfidf(tokens, idfs):\n    \"\"\" Compute TF-IDF\n    Args:\n        tokens (list of str): input list of tokens from tokenize\n        idfs (dictionary): record to IDF value\n    Returns:\n        dictionary: a dictionary of records to TF-IDF values\n    \"\"\"\n    # Calculate the token frequencies (TF) for tokens    \n    tfs = tf(tokens)\n    \n    # Create a Python dictionary where each token maps to the token's frequency times the token's IDF weight\n    tfIdfDict = {k: v * idfs[k] for (k,v) in tfs.items()}\n    \n    return tfIdfDict\n\nrecb000hkgj8k = amazonRecToToken.filter(lambda x: x[0] == 'b000hkgj8k').collect()[0][1]\nidfsSmallWeights = idfsSmall.collectAsMap()\nrec_b000hkgj8k_weights = tfidf(recb000hkgj8k, idfsSmallWeights)\n\nprint 'Amazon record \"b000hkgj8k\" has tokens and weights:\\n%s' % rec_b000hkgj8k_weights","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Amazon record &quot;b000hkgj8k&quot; has tokens and weights:\n{&apos;autocad&apos;: 33.33333333333333, &apos;autodesk&apos;: 8.333333333333332, &apos;courseware&apos;: 66.66666666666666, &apos;psg&apos;: 33.33333333333333, &apos;2007&apos;: 3.5087719298245617, &apos;customizing&apos;: 16.666666666666664, &apos;interface&apos;: 3.0303030303030303}\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.470072595237E12,"submitTime":1.470072581968E12,"finishTime":1.470072595465E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"7628cf17-fdf7-466d-86b1-e4f2e47a16b7"},{"version":"CommandV1","origId":2632367762420787,"guid":"86899b2f-e0db-472b-b037-99ee9057ab04","subtype":"command","commandType":"auto","position":43.0,"command":"# TEST Implement a TF-IDF function (2f)\nTest.assertEquals(rec_b000hkgj8k_weights,\n                   {'autocad': 33.33333333333333, 'autodesk': 8.333333333333332,\n                    'courseware': 66.66666666666666, 'psg': 33.33333333333333,\n                    '2007': 3.5087719298245617, 'customizing': 16.666666666666664,\n                    'interface': 3.0303030303030303}, 'incorrect rec_b000hkgj8k_weights')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.470072595472E12,"submitTime":1.47007258199E12,"finishTime":1.470072595544E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"2593e9ba-5192-4e0d-b083-d925506685fb"},{"version":"CommandV1","origId":2632367762420788,"guid":"c1d6bf61-3f54-493a-8232-076f2ea0f9c9","subtype":"command","commandType":"auto","position":44.0,"command":"%md\n#### **Part 3: ER as Text Similarity - Cosine Similarity**\nNow we are ready to do text comparisons in a formal way. The metric of string distance we will use is called **[cosine similarity][cosine]**. We will treat each document as a vector in some high dimensional space. Then, to compare two documents we compute the cosine of the angle between their two document vectors. This is *much* easier than it sounds.\n \nThe first question to answer is how do we represent documents as vectors? The answer is familiar: bag-of-words! We treat each unique token as a dimension, and treat token weights as magnitudes in their respective token dimensions. For example, suppose we use simple counts as weights, and we want to interpret the string \"Hello, world!  Goodbye, world!\" as a vector. Then in the \"hello\" and \"goodbye\" dimensions the vector has value 1, in the \"world\" dimension it has value 2, and it is zero in all other dimensions.\n \nThe next question is: given two vectors how do we find the cosine of the angle between them? Recall the formula for the dot product of two vectors:\n\\\\[ a \\cdot b = \\| a \\| \\| b \\| \\cos \\theta \\\\]\nHere \\\\( a \\cdot b = \\sum a_i b_i \\\\) is the ordinary dot product of two vectors, and \\\\( \\|a\\| = \\sqrt{ \\sum a_i^2 } \\\\) is the norm of \\\\( a \\\\).\n \nWe can rearrange terms and solve for the cosine to find it is simply the normalized dot product of the vectors. With our vector model, the dot product and norm computations are simple functions of the bag-of-words document representations, so we now have a formal way to compute similarity:\n\\\\[ similarity = \\cos \\theta = \\frac{a \\cdot b}{\\|a\\| \\|b\\|} = \\frac{\\sum a_i b_i}{\\sqrt{\\sum a_i^2} \\sqrt{\\sum b_i^2}} \\\\]\n \nSetting aside the algebra, the geometric interpretation is more intuitive. The angle between two document vectors is small if they share many tokens in common, because they are pointing in roughly the same direction. For that case, the cosine of the angle will be large. Otherwise, if the angle is large (and they have few words in common), the cosine is small. Therefore, cosine similarity scales proportionally with our intuitive sense of similarity.\n[cosine]: https://en.wikipedia.org/wiki/Cosine_similarity","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.470072582012E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"ff18f4ed-6f90-4fcd-89dc-b09203a177d5"},{"version":"CommandV1","origId":2632367762420789,"guid":"c1068a7c-e392-4a5a-b97b-a1c97f3e10fa","subtype":"command","commandType":"auto","position":45.0,"command":"%md\n#### **(3a) Implement the components of a `cosineSimilarity` function**\nImplement the components of a `cosineSimilarity` function.\nUse the `tokenize` and `tfidf` functions, and the IDF weights from Part 2 for extracting tokens and assigning them weights.\nThe steps you should perform are:\n* Define a function `dotprod` that takes two Python dictionaries and produces the dot product of them, where the dot product is defined as the sum of the product of values for tokens that appear in *both* dictionaries\n* Define a function `norm` that returns the square root of the dot product of a dictionary and itself\n* Define a function `cossim` that returns the dot product of two dictionaries divided by the norm of the first dictionary and then by the norm of the second dictionary","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.470072582042E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"9ac8fe6a-76f5-4d87-a194-e300f76a0e26"},{"version":"CommandV1","origId":2632367762420790,"guid":"349abf0c-bc85-4493-8fc2-6676a2de6eb4","subtype":"command","commandType":"auto","position":46.0,"command":"# TODO: Replace <FILL IN> with appropriate code\nimport math\n\ndef dotprod(a, b):\n    \"\"\" Compute dot product\n    Args:\n        a (dictionary): first dictionary of record to value\n        b (dictionary): second dictionary of record to value\n    Returns:\n        dotProd: result of the dot product with the two input dictionaries\n    \"\"\"\n    return sum([v * b[k] for (k,v) in a.items() if k in b.keys()])\n\ndef norm(a):\n    \"\"\" Compute square root of the dot product\n    Args:\n        a (dictionary): a dictionary of record to value\n    Returns:\n        norm (float): the square root of the dot product value\n    \"\"\"\n    return math.sqrt(dotprod(a, a))\n\ndef cossim(a, b):\n    \"\"\" Compute cosine similarity\n    Args:\n        a (dictionary): first dictionary of record to value\n        b (dictionary): second dictionary of record to value\n    Returns:\n        cossim: dot product of two dictionaries divided by the norm of the first dictionary and\n                then by the norm of the second dictionary\n    \"\"\"\n    return dotprod(a, b) / (norm(a) * norm(b))\n\ntestVec1 = {'foo': 2, 'bar': 3, 'baz': 5 }\ntestVec2 = {'foo': 1, 'bar': 0, 'baz': 20 }\ndp = dotprod(testVec1, testVec2)\nnm = norm(testVec1)\nprint dp, nm","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">102 6.16441400297\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.470072595549E12,"submitTime":1.470072582075E12,"finishTime":1.470072595624E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"410636f0-2f00-493e-8935-56ddb42bf7f5"},{"version":"CommandV1","origId":2632367762420791,"guid":"e3ff569f-2702-4d8e-88df-b92914910ac5","subtype":"command","commandType":"auto","position":47.0,"command":"# TEST Implement the components of a cosineSimilarity function (3a)\nTest.assertEquals(dp, 102, 'incorrect dp')\nTest.assertTrue(abs(nm - 6.16441400297) < 0.0000001, 'incorrrect nm')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.470072595629E12,"submitTime":1.470072582098E12,"finishTime":1.47007259567E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"036dc3a9-71ed-4092-8890-af95728aa474"},{"version":"CommandV1","origId":2632367762420792,"guid":"ce5036cb-cd08-4d5e-91bf-9db407281996","subtype":"command","commandType":"auto","position":48.0,"command":"%md\n#### **(3b) Implement a `cosineSimilarity` function**\nImplement a `cosineSimilarity(string1, string2, idfsDictionary)` function that takes two strings and a dictionary of IDF weights, and computes their cosine similarity in the context of some global IDF weights.\n \nThe steps you should perform are:\n* Apply your `tfidf` function to the tokenized first and second strings, using the dictionary of IDF weights\n* Compute and return your `cossim` function applied to the results of the two `tfidf` functions","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.470072582118E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"a7f67744-08ec-42c2-93e4-6da1f668e360"},{"version":"CommandV1","origId":2632367762420793,"guid":"1126718f-7369-4a3a-89a5-ee9243238e6c","subtype":"command","commandType":"auto","position":49.0,"command":"# TODO: Replace <FILL IN> with appropriate code\ndef cosineSimilarity(string1, string2, idfsDictionary):\n    \"\"\" Compute cosine similarity between two strings\n    Args:\n        string1 (str): first string\n        string2 (str): second string\n        idfsDictionary (dictionary): a dictionary of IDF values\n    Returns:\n        cossim: cosine similarity value\n    \"\"\"\n    w1 = tfidf(tokenize(string1), idfsDictionary)\n    w2 = tfidf(tokenize(string2), idfsDictionary)\n    return cossim(w1, w2)\n\ncossimAdobe = cosineSimilarity('Adobe Photoshop',\n                               'Adobe Illustrator',\n                               idfsSmallWeights)\n\nprint cossimAdobe","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">0.0577243382163\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.470072595675E12,"submitTime":1.47007258215E12,"finishTime":1.470072595715E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"0b963c04-0526-40e5-959f-f02c6ce3841d"},{"version":"CommandV1","origId":2632367762420794,"guid":"5aba48c4-340a-40e6-997f-262a55a229ff","subtype":"command","commandType":"auto","position":50.0,"command":"# TEST Implement a cosineSimilarity function (3b)\nTest.assertTrue(abs(cossimAdobe - 0.0577243382163) < 0.0000001, 'incorrect cossimAdobe')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.47007259572E12,"submitTime":1.470072582171E12,"finishTime":1.470072595737E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"76a9db83-9dd7-45b6-9987-77ec803a3dc6"},{"version":"CommandV1","origId":2632367762420795,"guid":"0ff739d0-a124-4e2d-b05c-3dca0c823b59","subtype":"command","commandType":"auto","position":51.0,"command":"%md\n#### **(3c) Perform Entity Resolution**\nNow we can finally do some entity resolution!\nFor *every* product record in the small Google dataset, use your `cosineSimilarity` function to compute its similarity to every record in the small Amazon dataset.  Then, build a dictionary mapping `(Google URL, Amazon ID)` tuples to similarity scores between 0 and 1.\nWe'll do this computation two different ways, first we'll do it without a broadcast variable, and then we'll use a broadcast variable\n \nThe steps you should perform are:\n* Create an RDD that is a combination of the small Google and small Amazon datasets that has as elements all pairs of elements (a, b) where a is in self and b is in other. The result will be an RDD of the form: `[ ((Google URL1, Google String1), (Amazon ID1, Amazon String1)), ((Google URL1, Google String1), (Amazon ID2, Amazon String2)), ((Google URL2, Google String2), (Amazon ID1, Amazon String1)), ... ]`\n* Define a worker function that given an element from the combination RDD computes the cosineSimlarity for the two records in the element\n* Apply the worker function to every element in the RDD\n \nNow, compute the similarity between Amazon record `b000o24l3q` and Google record `http://www.google.com/base/feeds/snippets/17242822440574356561`.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.470072582191E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"334127a3-0ecf-435b-8486-1ae94e9b23f1"},{"version":"CommandV1","origId":2632367762420796,"guid":"8b9f047e-333d-4629-a7ab-675ef593b9ca","subtype":"command","commandType":"auto","position":52.0,"command":"# TODO: Replace <FILL IN> with appropriate code\n\n# a combination of the small Google and small Amazon datasets that has as elements all pairs of elements (a, b) where a is in self and b is in other\ncrossSmall = (googleSmall\n              .cartesian(amazonSmall)\n              .cache())\n\n# a worker function that given an element from the combination RDD computes the cosineSimlarity for the two records in the element\ndef computeSimilarity(record):\n    \"\"\" Compute similarity on a combination record\n    Args:\n        record: a pair, (google record, amazon record)\n    Returns:\n        pair: a pair, (google URL, amazon ID, cosine similarity value)\n    \"\"\"\n    googleRec = record[0]\n    amazonRec = record[1]\n    googleURL = googleRec[0]\n    amazonID = amazonRec[0]\n    googleValue = googleRec[1]\n    amazonValue = amazonRec[1]\n    cs = cosineSimilarity(googleValue, amazonValue, idfsSmallWeights)\n    return (googleURL, amazonID, cs)\n\nsimilarities = (crossSmall\n                .map(lambda rec: computeSimilarity(rec))\n                .cache())\n\ndef similar(amazonID, googleURL):\n    \"\"\" Return similarity value\n    Args:\n        amazonID: amazon ID\n        googleURL: google URL\n    Returns:\n        similar: cosine similarity value\n    \"\"\"\n    return (similarities\n            .filter(lambda record: (record[0] == googleURL and record[1] == amazonID))\n            .collect()[0][2])\n\nsimilarityAmazonGoogle = similar('b000o24l3q', 'http://www.google.com/base/feeds/snippets/17242822440574356561')\nprint 'Requested similarity is %s.' % similarityAmazonGoogle","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Requested similarity is 0.000303171940451.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.470072595742E12,"submitTime":1.47007258222E12,"finishTime":1.470072598665E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"8a8bce3c-b598-4655-a9d4-d6232e1815a4"},{"version":"CommandV1","origId":2632367762420797,"guid":"f2d1fc25-d24f-4e04-8c87-14d14e0955c7","subtype":"command","commandType":"auto","position":53.0,"command":"# TEST Perform Entity Resolution (3c)\nTest.assertTrue(abs(similarityAmazonGoogle - 0.000303171940451) < 0.0000001,\n                'incorrect similarityAmazonGoogle') ","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.470072598672E12,"submitTime":1.470072582241E12,"finishTime":1.470072598687E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"d8eb9057-81bd-4433-8dbb-e29abd488561"},{"version":"CommandV1","origId":2632367762420798,"guid":"71ad90ad-0d5b-474c-a74f-18c859b02dac","subtype":"command","commandType":"auto","position":54.0,"command":"%md\n#### **(3d) Perform Entity Resolution with Broadcast Variables**\nThe solution in (3c) works well for small datasets, but it requires Spark to (automatically) send the `idfsSmallWeights` variable to all the workers. If we didn't `cache()` similarities, then it might have to be recreated if we run `similar()` multiple times. This would cause Spark to send `idfsSmallWeights` every time.\n \nInstead, we can use a broadcast variable - we define the broadcast variable in the driver and then we can refer to it in each worker. Spark saves the broadcast variable at each worker, so it is only sent once.\n \nThe steps you should perform are:\n* Define a `computeSimilarityBroadcast` function that given an element from the combination RDD computes the cosine simlarity for the two records in the element. This will be the same as the worker function `computeSimilarity` in (3c) except that it uses a broadcast variable.\n* Apply the worker function to every element in the RDD\n \nAgain, compute the similarity between Amazon record `b000o24l3q` and Google record `http://www.google.com/base/feeds/snippets/17242822440574356561`.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.470072582263E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"cc2d3d66-ea64-4a1f-8ac6-d3a002465e2f"},{"version":"CommandV1","origId":2632367762420799,"guid":"d2224529-1eae-4de2-9da4-00c73b063c4e","subtype":"command","commandType":"auto","position":55.0,"command":"# TODO: Replace <FILL IN> with appropriate code\ndef computeSimilarityBroadcast(record):\n    \"\"\" Compute similarity on a combination record, using Broadcast variable\n    Args:\n        record: a pair, (google record, amazon record)\n    Returns:\n        pair: a pair, (google URL, amazon ID, cosine similarity value)\n    \"\"\"\n    googleRec = record[0]\n    amazonRec = record[1]\n    googleURL = googleRec[0]\n    amazonID = amazonRec[0]\n    googleValue = googleRec[1]\n    amazonValue = amazonRec[1]\n    cs = cosineSimilarity(googleValue, amazonValue, idfsSmallBroadcast.value)\n    return (googleURL, amazonID, cs)\n\nidfsSmallBroadcast = sc.broadcast(idfsSmallWeights)\nsimilaritiesBroadcast = (crossSmall\n                         .map(lambda rec: computeSimilarityBroadcast(rec))\n                         .cache())\n\ndef similarBroadcast(amazonID, googleURL):\n    \"\"\" Return similarity value, computed using Broadcast variable\n    Args:\n        amazonID: amazon ID\n        googleURL: google URL\n    Returns:\n        similar: cosine similarity value\n    \"\"\"\n    return (similaritiesBroadcast\n            .filter(lambda record: (record[0] == googleURL and record[1] == amazonID))\n            .collect()[0][2])\n\nsimilarityAmazonGoogleBroadcast = similarBroadcast('b000o24l3q', 'http://www.google.com/base/feeds/snippets/17242822440574356561')\nprint 'Requested similarity is %s.' % similarityAmazonGoogleBroadcast","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Requested similarity is 0.000303171940451.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.470072598693E12,"submitTime":1.470072582312E12,"finishTime":1.470072601615E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"f02583fe-64f9-4955-8b9c-9fa0076ea70c"},{"version":"CommandV1","origId":2632367762420800,"guid":"ff81defd-2b6d-460e-8e2c-3d968b6eed3b","subtype":"command","commandType":"auto","position":56.0,"command":"# TEST Perform Entity Resolution with Broadcast Variables (3d)\nfrom pyspark import Broadcast\nTest.assertTrue(isinstance(idfsSmallBroadcast, Broadcast), 'incorrect idfsSmallBroadcast')\nTest.assertEquals(len(idfsSmallBroadcast.value), 4772, 'incorrect idfsSmallBroadcast value')\nTest.assertTrue(abs(similarityAmazonGoogleBroadcast - 0.000303171940451) < 0.0000001,\n                'incorrect similarityAmazonGoogle')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.47007260162E12,"submitTime":1.470072582333E12,"finishTime":1.470072601692E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"5d97e8d3-96f4-4624-b5bd-27167464c60a"},{"version":"CommandV1","origId":2632367762420801,"guid":"3a043906-baf2-4e9d-ae13-8a22c866d9ef","subtype":"command","commandType":"auto","position":57.0,"command":"%md\n#### **(3e) Perform a Gold Standard evaluation**\n \nFirst, we'll load the \"gold standard\" data and use it to answer several questions. We read and parse the Gold Standard data, where the format of each line is \"Amazon Product ID\",\"Google URL\". The resulting RDD has elements of the form (\"AmazonID GoogleURL\", 'gold')","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.470072582354E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"ad7e0216-abda-416e-907b-770fb02ccda5"},{"version":"CommandV1","origId":2632367762420802,"guid":"9daa79d9-fe2c-483e-b303-515eafaaea56","subtype":"command","commandType":"auto","position":58.0,"command":"GOLDFILE_PATTERN = '^(.+),(.+)'\n\n# Parse each line of a data file useing the specified regular expression pattern\ndef parse_goldfile_line(goldfile_line):\n    \"\"\" Parse a line from the 'golden standard' data file\n    Args:\n        goldfile_line: a line of data\n    Returns:\n        pair: ((key, 'gold', 1 if successful or else 0))\n    \"\"\"\n    match = re.search(GOLDFILE_PATTERN, goldfile_line)\n    if match is None:\n        print 'Invalid goldfile line: %s' % goldfile_line\n        return (goldfile_line, -1)\n    elif match.group(1) == '\"idAmazon\"':\n        print 'Header datafile line: %s' % goldfile_line\n        return (goldfile_line, 0)\n    else:\n        key = '%s %s' % (removeQuotes(match.group(1)), removeQuotes(match.group(2)))\n        return ((key, 'gold'), 1)\n\ngoldfile = os.path.join(baseDir, inputPath, GOLD_STANDARD_PATH)\ngsRaw = (sc\n         .textFile(goldfile)\n         .map(parse_goldfile_line)\n         .cache())\n\ngsFailed = (gsRaw\n            .filter(lambda s: s[1] == -1)\n            .map(lambda s: s[0]))\nfor line in gsFailed.take(10):\n    print 'Invalid goldfile line: %s' % line\n\ngoldStandard = (gsRaw\n                .filter(lambda s: s[1] == 1)\n                .map(lambda s: s[0])\n                .cache())\n\nprint 'Read %d lines, successfully parsed %d lines, failed to parse %d lines' % (gsRaw.count(),\n                                                                                 goldStandard.count(),\n                                                                                 gsFailed.count())\nassert (gsFailed.count() == 0)\nassert (gsRaw.count() == (goldStandard.count() + 1))","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Read 1301 lines, successfully parsed 1300 lines, failed to parse 0 lines\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.470072601697E12,"submitTime":1.470072582384E12,"finishTime":1.470072602588E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"9a203dc7-fbd0-4197-bed1-18d5d34e5e47"},{"version":"CommandV1","origId":2632367762420803,"guid":"cd44f75b-0edf-432b-a76c-6e1e075b62b2","subtype":"command","commandType":"auto","position":59.0,"command":"%md\n#### Using the \"gold standard\" data we can answer the following questions:\n \n* How many true duplicate pairs are there in the small datasets?\n* What is the average similarity score for true duplicates?\n* What about for non-duplicates?\nThe steps you should perform are:\n* Create a new `sims` RDD from the `similaritiesBroadcast` RDD, where each element consists of a pair of the form (\"AmazonID GoogleURL\", cosineSimilarityScore). An example entry from `sims` is: ('b000bi7uqs http://www.google.com/base/feeds/snippets/18403148885652932189', 0.40202896125621296)\n* Combine the `sims` RDD with the `goldStandard` RDD by creating a new `trueDupsRDD` RDD that has the just the cosine similarity scores for those \"AmazonID GoogleURL\" pairs that appear in both the `sims` RDD and `goldStandard` RDD. Hint: you can do this using the join() transformation.\n* Count the number of true duplicate pairs in the `trueDupsRDD` dataset\n* Compute the average similarity score for true duplicates in the `trueDupsRDD` datasets. Remember to use `float` for calculation\n* Create a new `nonDupsRDD` RDD that has the just the cosine similarity scores for those \"AmazonID GoogleURL\" pairs from the `similaritiesBroadcast` RDD that **do not** appear in both the *sims* RDD and gold standard RDD.\n* Compute the average similarity score for non-duplicates in the last datasets. Remember to use `float` for calculation","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.470072582406E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"8aadb65d-fd2b-4dc1-9512-57bc5b9b992d"},{"version":"CommandV1","origId":2632367762420804,"guid":"64be78e3-1ea2-4fc0-8b1b-6acb3848ee38","subtype":"command","commandType":"auto","position":60.0,"command":"# TODO: Replace <FILL IN> with appropriate code\nsims = similaritiesBroadcast.map(lambda rec: (\"{0} {1}\".format(rec[1],rec[0]),rec[2]))\n\ntrueDupsRDD = (sims\n               .join(goldStandard))\ntrueDupsCount = trueDupsRDD.count()\navgSimDups = trueDupsRDD.map(lambda rec: rec[1][0]).mean()\n\nnonDupsRDD = (sims\n              .subtractByKey(trueDupsRDD))\navgSimNon = nonDupsRDD.map(lambda rec: rec[1]).mean()\n\nprint 'There are %s true duplicates.' % trueDupsCount\nprint 'The average similarity of true duplicates is %s.' % avgSimDups\nprint 'And for non duplicates, it is %s.' % avgSimNon","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">There are 146 true duplicates.\nThe average similarity of true duplicates is 0.264332573435.\nAnd for non duplicates, it is 0.00123476304656.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">TypeError</span>: map() requires at least two args","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">TypeError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-43-d43270cb84b6&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      5</span>                .join(goldStandard))\n<span class=\"ansigreen\">      6</span> trueDupsCount <span class=\"ansiyellow\">=</span> trueDupsRDD<span class=\"ansiyellow\">.</span>count<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 7</span><span class=\"ansiyellow\"> </span>avgSimDups <span class=\"ansiyellow\">=</span> map<span class=\"ansiyellow\">(</span><span class=\"ansigreen\">lambda</span> rec<span class=\"ansiyellow\">:</span> rec<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>mean<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      8</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      9</span> nonDupsRDD = (sims\n\n<span class=\"ansired\">TypeError</span>: map() requires at least two args\n</div>","workflows":[],"startTime":1.470072602593E12,"submitTime":1.470072582434E12,"finishTime":1.470072604509E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"f09611cc-d4c9-4f20-abee-b29f50b09ec9"},{"version":"CommandV1","origId":2632367762420805,"guid":"ae9eccfc-845c-4362-b791-363acd54f7a1","subtype":"command","commandType":"auto","position":61.0,"command":"# TEST Perform a Gold Standard evaluation (3e)\nTest.assertEquals(trueDupsCount, 146, 'incorrect trueDupsCount')\nTest.assertTrue(abs(avgSimDups - 0.264332573435) < 0.0000001, 'incorrect avgSimDups')\nTest.assertTrue(abs(avgSimNon - 0.00123476304656) < 0.0000001, 'incorrect avgSimNon')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.470072604516E12,"submitTime":1.470072582455E12,"finishTime":1.470072604556E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"fdc147ba-6df9-417b-9d95-c387d5164235"},{"version":"CommandV1","origId":2632367762420806,"guid":"45aa103a-ad6a-4ca2-9002-2b97bdf99c48","subtype":"command","commandType":"auto","position":62.0,"command":"%md\n#### **Part 4: Scalable ER**\nIn the previous parts, we built a text similarity function and used it for small scale entity resolution.  Our implementation is limited by its quadratic run time complexity, and is not practical for even modestly sized datasets.  In this part, we will implement a more scalable algorithm and use it to do entity resolution on the full dataset.\n \n#### Inverted Indices\nTo improve our ER algorithm from the earlier parts, we should begin by analyzing its running time. In particular, the algorithm above is quadratic in two ways. First, we did a lot of redundant computation of tokens and weights, since each record was reprocessed every time it was compared. Second, we made quadratically many token comparisons between records.\n \nThe first source of quadratic overhead can be eliminated with precomputation and look-up tables, but the second source is a little more tricky. In the worst case, every token in every record in one dataset exists in every record in the other dataset, and therefore every token makes a non-zero contribution to the cosine similarity. In this case, token comparison is unavoidably quadratic.\n \nBut in reality most records have nothing (or very little) in common. Moreover, it is typical for a record in one dataset to have at most one duplicate record in the other dataset (this is the case assuming each dataset has been de-duplicated against itself). In this case, the output is linear in the size of the input and we can hope to achieve linear running time.\n \nAn [**inverted index**](https://en.wikipedia.org/wiki/Inverted_index) is a data structure that will allow us to avoid making quadratically many token comparisons.  It maps each token in the dataset to the list of documents that contain the token.  So, instead of comparing, record by record, each token to every other token to see if they match, we will use inverted indices to *look up* records that match on a particular token.\n \n> **Note on terminology**: In text search, a *forward* index maps documents in a dataset to the tokens they contain.  An *inverted* index supports the inverse mapping.\n \n> **Note**: For this section, use the complete Google and Amazon datasets, not the samples","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.470072582476E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"003a8911-2dad-427d-bfe9-8c82219681c5"},{"version":"CommandV1","origId":2632367762420807,"guid":"d25c073d-12a1-4454-b10b-40ac3be4f6b0","subtype":"command","commandType":"auto","position":63.0,"command":"%md\n#### **(4a) Tokenize the full dataset**\nTokenize each of the two full datasets for Google and Amazon.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.470072582513E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"3dcb32db-374a-4422-a7cd-66ffe5d0dc85"},{"version":"CommandV1","origId":2632367762420808,"guid":"17a2e43c-123d-409e-87ec-17a9898ce20c","subtype":"command","commandType":"auto","position":64.0,"command":"# TODO: Replace <FILL IN> with appropriate code\namazonFullRecToToken = amazon.map(lambda rec: (rec[0], tokenize(rec[1])))\ngoogleFullRecToToken = google.map(lambda rec: (rec[0], tokenize(rec[1])))\nprint 'Amazon full dataset is %s products, Google full dataset is %s products' % (amazonFullRecToToken.count(),\n                                                                                    googleFullRecToToken.count())","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Amazon full dataset is 1363 products, Google full dataset is 3226 products\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.470072604561E12,"submitTime":1.470072582553E12,"finishTime":1.470072604739E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"65e60ab9-40b7-4f6b-a82d-cfefca179e01"},{"version":"CommandV1","origId":2632367762420809,"guid":"9e12d3c1-2373-4f8c-8a4e-35c047241e8c","subtype":"command","commandType":"auto","position":65.0,"command":"# TEST Tokenize the full dataset (4a)\nTest.assertEquals(amazonFullRecToToken.count(), 1363, 'incorrect amazonFullRecToToken.count()')\nTest.assertEquals(googleFullRecToToken.count(), 3226, 'incorrect googleFullRecToToken.count()')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.470072604745E12,"submitTime":1.470072582573E12,"finishTime":1.470072604967E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"e70c0ead-d270-44e0-9923-f4e229b2c9b4"},{"version":"CommandV1","origId":2632367762420810,"guid":"9b008bcf-0973-4a84-9383-55b2d3bb4266","subtype":"command","commandType":"auto","position":66.0,"command":"%md\n#### **(4b) Compute IDFs and TF-IDFs for the full datasets**\n \nWe will reuse your code from above to compute IDF weights for the complete combined datasets.\nThe steps you should perform are:\n* Create a new `fullCorpusRDD` that contains the tokens from the full Amazon and Google datasets.\n* Apply your `idfs` function to the `fullCorpusRDD`\n* Create a broadcast variable containing a dictionary of the IDF weights for the full dataset.\n* For each of the Amazon and Google full datasets, create weight RDDs that map IDs/URLs to TF-IDF weighted token vectors.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.470072582595E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"95e9dac1-177d-4250-875c-a7c560d08efd"},{"version":"CommandV1","origId":2632367762420811,"guid":"3d391664-016a-4b6b-8810-29540f77c11f","subtype":"command","commandType":"auto","position":67.0,"command":"# TODO: Replace <FILL IN> with appropriate code\nfullCorpusRDD = amazonFullRecToToken + googleFullRecToToken\nidfsFull = idfs(fullCorpusRDD)\nidfsFullCount = idfsFull.count()\nprint 'There are %s unique tokens in the full datasets.' % idfsFullCount\n\n# Recompute IDFs for full dataset\nidfsFullWeights = idfsFull.collectAsMap()\nidfsFullBroadcast = sc.broadcast(idfsFullWeights)\n\n# Pre-compute TF-IDF weights.  Build mappings from record ID weight vector.\namazonWeightsRDD = amazonFullRecToToken.map(lambda rec: (rec[0],tfidf(rec[1], idfsFullBroadcast.value)))\ngoogleWeightsRDD = googleFullRecToToken.map(lambda rec: (rec[0],tfidf(rec[1], idfsFullBroadcast.value)))\nprint 'There are %s Amazon weights and %s Google weights.' % (amazonWeightsRDD.count(),\n                                                              googleWeightsRDD.count())","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">There are 17078 unique tokens in the full datasets.\nThere are 1363 Amazon weights and 3226 Google weights.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax","error":"<div class=\"ansiout\"><span class=\"ansicyan\">  File </span><span class=\"ansigreen\">&quot;&lt;ipython-input-48-e7adec049ba9&gt;&quot;</span><span class=\"ansicyan\">, line </span><span class=\"ansigreen\">8</span>\n<span class=\"ansiyellow\">    idfsFullWeights = &lt;FILL IN&gt;</span>\n<span class=\"ansigrey\">                      ^</span>\n<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax\n\n</div>","workflows":[],"startTime":1.470072604972E12,"submitTime":1.470072582626E12,"finishTime":1.47007260597E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"fdb0bc7e-045d-4773-b93f-0d2fdc4254b1"},{"version":"CommandV1","origId":2632367762420812,"guid":"8edf7297-c20e-4741-8ab5-0855d8b31755","subtype":"command","commandType":"auto","position":68.0,"command":"# TEST Compute IDFs and TF-IDFs for the full datasets (4b)\nTest.assertEquals(idfsFullCount, 17078, 'incorrect idfsFullCount')\nTest.assertEquals(amazonWeightsRDD.count(), 1363, 'incorrect amazonWeightsRDD.count()')\nTest.assertEquals(googleWeightsRDD.count(), 3226, 'incorrect googleWeightsRDD.count()')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.470072605976E12,"submitTime":1.47007258267E12,"finishTime":1.4700726062E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"5f971504-99c5-4ba7-8e69-1e36587cbdc2"},{"version":"CommandV1","origId":2632367762420813,"guid":"86b55679-3366-4969-b9ff-6adfddcbdec5","subtype":"command","commandType":"auto","position":69.0,"command":"%md\n#### **(4c) Compute Norms for the weights from the full datasets**\n \nWe will reuse your code from above to compute norms of the IDF weights for the complete combined dataset.\nThe steps you should perform are:\n* Create two collections, one for each of the full Amazon and Google datasets, where IDs/URLs map to the norm of the associated TF-IDF weighted token vectors.\n* Convert each collection into a broadcast variable, containing a dictionary of the norm of IDF weights for the full dataset","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.470072582756E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"b34a5b67-bf88-4070-b601-5517fc28203d"},{"version":"CommandV1","origId":2632367762420814,"guid":"d07740da-6d6e-40d0-b183-b3fb966e8201","subtype":"command","commandType":"auto","position":70.0,"command":"# TODO: Replace <FILL IN> with appropriate code\namazonNorms = amazonWeightsRDD.map(lambda (url, weights): (url, norm(weights))) \namazonNormsBroadcast = sc.broadcast(amazonNorms.collect())\ngoogleNorms = googleWeightsRDD.map(lambda (url, weights): (url, norm(weights)))\ngoogleNormsBroadcast = sc.broadcast(googleNorms.collect())","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.470072606205E12,"submitTime":1.470072582791E12,"finishTime":1.470072606629E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"dba68e3a-ffb1-401f-8aaa-e8026642b7cf"},{"version":"CommandV1","origId":2632367762420815,"guid":"7312b641-0de2-4cc0-8765-741edbfa9490","subtype":"command","commandType":"auto","position":71.0,"command":"# TEST Compute Norms for the weights from the full datasets (4c)\nTest.assertTrue(isinstance(amazonNormsBroadcast, Broadcast), 'incorrect amazonNormsBroadcast')\nTest.assertEquals(len(amazonNormsBroadcast.value), 1363, 'incorrect amazonNormsBroadcast.value')\nTest.assertTrue(isinstance(googleNormsBroadcast, Broadcast), 'incorrect googleNormsBroadcast')\nTest.assertEquals(len(googleNormsBroadcast.value), 3226, 'incorrect googleNormsBroadcast.value')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.470072606634E12,"submitTime":1.470072582812E12,"finishTime":1.470072606658E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"86a3abee-e112-48ab-88e9-93b2b9bed1a5"},{"version":"CommandV1","origId":2632367762420816,"guid":"372b721b-573a-48c6-b097-b91d1d3e6451","subtype":"command","commandType":"auto","position":72.0,"command":"%md\n#### **(4d) Create inverted indicies from the full datasets**\n \nBuild inverted indices of both data sources.\nThe steps you should perform are:\n* Create an invert function that given a pair of (ID/URL, TF-IDF weighted token vector), returns a list of pairs of (token, ID/URL). Recall that the TF-IDF weighted token vector is a Python dictionary with keys that are tokens and values that are weights.\n* Use your invert function to convert the full Amazon and Google TF-IDF weighted token vector datasets into two RDDs where each element is a pair of a token and an ID/URL that contain that token. These are inverted indicies.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.470072582831E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"2a917898-05be-458b-b4aa-653114853597"},{"version":"CommandV1","origId":2632367762420817,"guid":"e6c1b70a-bc99-4a8c-b225-e8bf2671d13c","subtype":"command","commandType":"auto","position":73.0,"command":"# TODO: Replace <FILL IN> with appropriate code\ndef invert(record):\n    \"\"\" Invert (ID, tokens) to a list of (token, ID)\n    Args:\n        record: a pair, (ID, token vector)\n    Returns:\n        pairs: a list of pairs of token to ID\n    \"\"\"\n    id_url = record[0]\n    weights = record[1]\n    pairs = [(token, id_url) for (token, weight) in weights.items()]\n    \n    return (pairs)\n\namazonInvPairsRDD = (amazonWeightsRDD\n                    .flatMap(lambda rec: invert(rec))\n                    .cache())\n\ngoogleInvPairsRDD = (googleWeightsRDD\n                    .flatMap(lambda rec: invert(rec))\n                    .cache())\n\nprint 'There are %s Amazon inverted pairs and %s Google inverted pairs.' % (amazonInvPairsRDD.count(),\n                                                                            googleInvPairsRDD.count())","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">There are 111387 Amazon inverted pairs and 77678 Google inverted pairs.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.470072606663E12,"submitTime":1.470072582858E12,"finishTime":1.470072607038E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"ed24fa39-ea00-47eb-b89b-405a76566b08"},{"version":"CommandV1","origId":2632367762420818,"guid":"1a256821-1f4d-4517-a29a-4b6fe61e9829","subtype":"command","commandType":"auto","position":74.0,"command":"# TEST Create inverted indicies from the full datasets (4d)\ninvertedPair = invert((1, {'foo': 2}))\nTest.assertEquals(invertedPair[0][1], 1, 'incorrect invert result')\nTest.assertEquals(amazonInvPairsRDD.count(), 111387, 'incorrect amazonInvPairsRDD.count()')\nTest.assertEquals(googleInvPairsRDD.count(), 77678, 'incorrect googleInvPairsRDD.count()')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.470072607043E12,"submitTime":1.470072582878E12,"finishTime":1.470072607165E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"54aa458d-5a92-4c42-9dc9-e1ae54632caa"},{"version":"CommandV1","origId":2632367762420819,"guid":"edccfe72-6380-43db-af8f-0bb08b966acc","subtype":"command","commandType":"auto","position":75.0,"command":"%md\n#### **(4e) Identify common tokens from the full dataset**\n \nWe are now in position to efficiently perform ER on the full datasets. Implement the following algorithm to build an RDD that maps a pair of (ID, URL) to a list of tokens they share in common:\n* Using the two inverted indicies (RDDs where each element is a pair of a token and an ID or URL that contains that token), create a new RDD that contains only tokens that appear in both datasets. This will yield an RDD of pairs of (token, iterable(ID, URL)).\n* We need a mapping from (ID, URL) to token, so create a function that will swap the elements of the RDD you just created to create this new RDD consisting of ((ID, URL), token) pairs.\n* Finally, create an RDD consisting of pairs mapping (ID, URL) to all the tokens the pair shares in common","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.470072582898E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"eaf4b835-8f70-47df-ac75-172cb7b86ad9"},{"version":"CommandV1","origId":2632367762420820,"guid":"33797a20-9310-4f59-abe6-a62e05adb3a9","subtype":"command","commandType":"auto","position":76.0,"command":"# TODO: Replace <FILL IN> with appropriate code\ndef swap(record):\n    \"\"\" Swap (token, (ID, URL)) to ((ID, URL), token)\n    Args:\n        record: a pair, (token, (ID, URL))\n    Returns:\n        pair: ((ID, URL), token)\n    \"\"\"\n    token = record[0]\n    keys = record[1]\n    return (keys, token)\n\ncommonTokens = (amazonInvPairsRDD\n                .join(googleInvPairsRDD)\n                .map(lambda rec: swap(rec))\n                .groupByKey()\n                .map(lambda rec: (rec[0], list(rec[1])))\n                .cache())\n\nprint 'Found %d common tokens' % commonTokens.count()","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Found 2441100 common tokens\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.47007260717E12,"submitTime":1.470072582932E12,"finishTime":1.470072636571E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"4ed60aba-7f40-4a2f-9210-1844cdb5eba8"},{"version":"CommandV1","origId":2632367762420821,"guid":"42ce5322-88ed-4b1a-8426-28d9e37e8ff7","subtype":"command","commandType":"auto","position":77.0,"command":"# TEST Identify common tokens from the full dataset (4e)\nTest.assertEquals(commonTokens.count(), 2441100, 'incorrect commonTokens.count()')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.470072636577E12,"submitTime":1.470072583183E12,"finishTime":1.470072637686E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"d0eac518-1dae-4b0c-9a18-354154397adb"},{"version":"CommandV1","origId":2632367762420822,"guid":"1ac8f5a2-cdf2-458b-8ff4-f18830b52d66","subtype":"command","commandType":"auto","position":78.0,"command":"%md\n#### **(4f) Identify common tokens from the full dataset**\n \nUse the data structures from parts **(4a)** and **(4e)** to build a dictionary to map record pairs to cosine similarity scores.\nThe steps you should perform are:\n* Create two broadcast dictionaries from the amazonWeights and googleWeights RDDs\n* Create a `fastCosinesSimilarity` function that takes in a record consisting of the pair ((Amazon ID, Google URL), tokens list) and computes the sum for each of the tokens in the token list of the products of the Amazon weight for the token times the Google weight for the token. The sum should then be divided by the norm for the Google URL and then divided by the norm for the Amazon ID. The function should return this value in a pair with the key being the (Amazon ID, Google URL). *Make sure you use broadcast variables you created for both the weights and norms*\n* Apply your `fastCosinesSimilarity` function to the common tokens from the full dataset","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.470072583204E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"4d629703-893f-4e6d-a384-a325093813cb"},{"version":"CommandV1","origId":2632367762420823,"guid":"2a5e3a52-1ccb-4830-931a-22315e04b8e5","subtype":"command","commandType":"auto","position":79.0,"command":"# TODO: Replace <FILL IN> with appropriate code\namazonWeightsBroadcast = sc.broadcast(amazonWeightsRDD.collectAsMap())\ngoogleWeightsBroadcast = sc.broadcast(googleWeightsRDD.collectAsMap())\n\ndef fastCosineSimilarity(record):\n    \"\"\" Compute Cosine Similarity using Broadcast variables\n    Args:\n        record: ((ID, URL), token)\n    Returns:\n        pair: ((ID, URL), cosine similarity value)\n    \"\"\"\n    amazonRec = record[0][0]\n    googleRec = record[0][1]\n    tokens = record[1]\n    s = sum([(amazonWeightsBroadcast.value[amazonRec][token] * googleWeightsBroadcast.value[googleRec][token]) for token in tokens]) \n    value = s / dict(amazonNormsBroadcast.value)[amazonRec] / dict(googleNormsBroadcast.value)[googleRec]\n    key = (amazonRec, googleRec)\n    return (key, value)\n\nsimilaritiesFullRDD = (commonTokens\n                       .map(lambda record: fastCosineSimilarity(record))\n                       .cache())\n\nprint similaritiesFullRDD.count()","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">2441100\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.470072637693E12,"submitTime":1.470072583227E12,"finishTime":1.470072794483E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"8e7faccb-7653-4ef9-9f35-09dda8b93e01"},{"version":"CommandV1","origId":2632367762420824,"guid":"95ad45df-7590-401e-a7f6-1e38a9beb816","subtype":"command","commandType":"auto","position":80.0,"command":"# TEST Identify common tokens from the full dataset (4f)\nsimilarityTest = similaritiesFullRDD.filter(lambda ((aID, gURL), cs): aID == 'b00005lzly' and gURL == 'http://www.google.com/base/feeds/snippets/13823221823254120257').collect()\nTest.assertEquals(len(similarityTest), 1, 'incorrect len(similarityTest)')\nTest.assertTrue(abs(similarityTest[0][1] - 4.286548414e-06) < 0.000000000001, 'incorrect similarityTest fastCosineSimilarity')\nTest.assertEquals(similaritiesFullRDD.count(), 2441100, 'incorrect similaritiesFullRDD.count()')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.47007279449E12,"submitTime":1.470072583247E12,"finishTime":1.470072795802E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"49898b06-7793-4400-8db7-b7613198387b"},{"version":"CommandV1","origId":2632367762420825,"guid":"289de7ee-34ec-4eba-a59f-6f9198575e41","subtype":"command","commandType":"auto","position":81.0,"command":"%md\n#### **Part 5: Analysis**\n \nNow we have an authoritative list of record-pair similarities, but we need a way to use those similarities to decide if two records are duplicates or not. The simplest approach is to pick a **threshold**. Pairs whose similarity is above the threshold are declared duplicates, and pairs below the threshold are declared distinct.\n \nTo decide where to set the threshold we need to understand what kind of errors result at different levels. If we set the threshold too low, we get more **false positives**, that is, record-pairs we say are duplicates that in reality are not. If we set the threshold too high, we get more **false negatives**, that is, record-pairs that really are duplicates but that we miss.\n \nER algorithms are evaluated by the common metrics of information retrieval and search called **precision** and **recall**. Precision asks of all the record-pairs marked duplicates, what fraction are true duplicates? Recall asks of all the true duplicates in the data, what fraction did we successfully find? As with false positives and false negatives, there is a trade-off between precision and recall. A third metric, called **F-measure**, takes the harmonic mean of precision and recall to measure overall goodness in a single value:\n\\\\[ Fmeasure = 2 \\frac{precision * recall}{precision + recall} \\\\]\n \n> **Note**: In this part, we use the \"gold standard\" mapping from the included file to look up true duplicates, and the results of Part 4.\n \n> **Note**: In this part, you will not be writing any code. We've written all of the code for you. Run each cell and then answer the quiz questions on Studio.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.470072583265E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"bb88feb3-e0f5-49be-aa69-34dd3ca59c74"},{"version":"CommandV1","origId":2632367762420826,"guid":"5925e795-32ef-456c-8985-3733e5a0c958","subtype":"command","commandType":"auto","position":82.0,"command":"%md\n#### **(5a) Counting True Positives, False Positives, and False Negatives**\n \nWe need functions that count True Positives (true duplicates above the threshold), and False Positives and False Negatives:\n* We start with creating the `simsFullRDD` from our `similaritiesFullRDD` that consists of a pair of ((Amazon ID, Google URL), simlarity score)\n* From this RDD, we create an RDD consisting of only the similarity scores\n* To look up the similarity scores for true duplicates, we perform a left outer join using the `goldStandard` RDD and `simsFullRDD` and extract the","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.47007258329E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"dfc29b34-645f-49e2-a824-d696c1fca18f"},{"version":"CommandV1","origId":2632367762420827,"guid":"06f29793-8e10-46e8-a1aa-c53a04902319","subtype":"command","commandType":"auto","position":83.0,"command":"# Create an RDD of ((Amazon ID, Google URL), similarity score)\nsimsFullRDD = similaritiesFullRDD.map(lambda x: (\"%s %s\" % (x[0][0], x[0][1]), x[1]))\nassert (simsFullRDD.count() == 2441100)\n\n# Create an RDD of just the similarity scores\nsimsFullValuesRDD = (simsFullRDD\n                     .map(lambda x: x[1])\n                     .cache())\nassert (simsFullValuesRDD.count() == 2441100)\n\n# Look up all similarity scores for true duplicates\n\n# This helper function will return the similarity score for records that are in the gold standard and the simsFullRDD (True positives), and will return 0 for records that are in the gold standard but not in simsFullRDD (False Negatives).\ndef gs_value(record):\n    if (record[1][1] is None):\n        return 0\n    else:\n        return record[1][1]\n\n# Join the gold standard and simsFullRDD, and then extract the similarities scores using the helper function\ntrueDupSimsRDD = (goldStandard\n                  .leftOuterJoin(simsFullRDD)\n                  .map(gs_value)\n                  .cache())\nprint 'There are %s true duplicates.' % trueDupSimsRDD.count()\nassert(trueDupSimsRDD.count() == 1300)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">There are 1300 true duplicates.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.470072795807E12,"submitTime":1.470072583321E12,"finishTime":1.470072816029E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"4f287e74-b292-4a5b-bd28-77ab7ef1da12"},{"version":"CommandV1","origId":2632367762420828,"guid":"1a1c18b9-45b1-415b-b1b8-ff14ae278439","subtype":"command","commandType":"auto","position":84.0,"command":"%md\nThe next step is to pick a threshold between 0 and 1 for the count of True Positives (true duplicates above the threshold). However, we would like to explore many different thresholds.\n \nTo do this, we divide the space of thresholds into 100 bins, and take the following actions:\n* We use Spark Accumulators to implement our counting function. We define a custom accumulator type, `VectorAccumulatorParam`, along with functions to initialize the accumulator's vector to zero, and to add two vectors. Note that we have to use the += operator because you can only add to an accumulator.\n* We create a helper function to create a list with one entry (bit) set to a value and all others set to 0.\n* We create 101 bins for the 100 threshold values between 0 and 1.\n* Now, for each similarity score, we can compute the false positives. We do this by adding each similarity score to the appropriate bin of the vector. Then we remove true positives from the vector by using the gold standard data.\n* We define functions for computing false positive and negative and true positives, for a given threshold.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.470072583341E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"08bc8049-c175-4bb2-8e8b-5ccbd5422f1d"},{"version":"CommandV1","origId":2632367762420829,"guid":"8dd6d299-961d-4164-aa2a-31b17f800488","subtype":"command","commandType":"auto","position":85.0,"command":"from pyspark.accumulators import AccumulatorParam\nclass VectorAccumulatorParam(AccumulatorParam):\n    # Initialize the VectorAccumulator to 0\n    def zero(self, value):\n        return [0] * len(value)\n\n    # Add two VectorAccumulator variables\n    def addInPlace(self, val1, val2):\n        for i in xrange(len(val1)):\n            val1[i] += val2[i]\n        return val1\n\n# Return a list with entry x set to value and all other entries set to 0\ndef set_bit(x, value, length):\n    bits = []\n    for y in xrange(length):\n        if (x == y):\n          bits.append(value)\n        else:\n          bits.append(0)\n    return bits\n\n# Pre-bin counts of false positives for different threshold ranges\nBINS = 101\nnthresholds = 100\ndef bin(similarity):\n    return int(similarity * nthresholds)\n\n# fpCounts[i] = number of entries (possible false positives) where bin(similarity) == i\nzeros = [0] * BINS\nfpCounts = sc.accumulator(zeros, VectorAccumulatorParam())\n\ndef add_element(score):\n    global fpCounts\n    b = bin(score)\n    fpCounts += set_bit(b, 1, BINS)\n\nsimsFullValuesRDD.foreach(add_element)\n\n# Remove true positives from FP counts\ndef sub_element(score):\n    global fpCounts\n    b = bin(score)\n    fpCounts += set_bit(b, -1, BINS)\n\ntrueDupSimsRDD.foreach(sub_element)\n\ndef falsepos(threshold):\n    fpList = fpCounts.value\n    return sum([fpList[b] for b in range(0, BINS) if float(b) / nthresholds >= threshold])\n\ndef falseneg(threshold):\n    return trueDupSimsRDD.filter(lambda x: x < threshold).count()\n\ndef truepos(threshold):\n    return trueDupSimsRDD.count() - falsenegDict[threshold]\n","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.470072816034E12,"submitTime":1.470072583366E12,"finishTime":1.470072831641E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"89f7cbaf-d426-42bb-bd7c-099a07679452"},{"version":"CommandV1","origId":2632367762420830,"guid":"aab43d9f-e3b9-4019-ae9b-e166c5d27e96","subtype":"command","commandType":"auto","position":86.0,"command":"%md\n#### **(5b) Precision, Recall, and F-measures**\nWe define functions so that we can compute the [Precision](https://en.wikipedia.org/wiki/Precision_and_recall), [Recall](https://en.wikipedia.org/wiki/Precision_and_recall), and [F-measure](https://en.wikipedia.org/wiki/Precision_and_recall#F-measure) as a function of threshold value:\n* Precision = true-positives / (true-positives + false-positives)\n* Recall = true-positives / (true-positives + false-negatives)\n* F-measure = 2 x Recall x Precision / (Recall + Precision)","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.470072583388E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"e6a448f7-b87f-42d2-8fb1-27fd94fffe29"},{"version":"CommandV1","origId":2632367762420831,"guid":"6ea62f3d-692b-4b81-9bc8-f46b17385dd0","subtype":"command","commandType":"auto","position":87.0,"command":"# Precision = true-positives / (true-positives + false-positives)\n# Recall = true-positives / (true-positives + false-negatives)\n# F-measure = 2 x Recall x Precision / (Recall + Precision)\n\ndef precision(threshold):\n    tp = trueposDict[threshold]\n    fp = falseposDict[threshold]\n    return float(tp) / (tp + fp)\n\ndef recall(threshold):\n    tp = trueposDict[threshold]\n    fn = falsenegDict[threshold]\n    return float(tp) / (tp + fn)\n\ndef fmeasure(threshold):\n    r = recall(threshold)\n    p = precision(threshold)\n    return 2 * r * p / (r + p)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax","error":"<div class=\"ansiout\"><span class=\"ansicyan\">  File </span><span class=\"ansigreen\">&quot;&lt;ipython-input-64-33e7541526b1&gt;&quot;</span><span class=\"ansicyan\">, line </span><span class=\"ansigreen\">7</span>\n<span class=\"ansiyellow\">    return &lt;FILL IN&gt;</span>\n<span class=\"ansigrey\">           ^</span>\n<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax\n\n</div>","workflows":[],"startTime":1.470072831647E12,"submitTime":1.470072583414E12,"finishTime":1.470072831723E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"fe8db877-d589-4647-9014-828b956e208f"},{"version":"CommandV1","origId":2632367762420832,"guid":"6dad29f4-561b-4814-8c0d-21e1386aefc4","subtype":"command","commandType":"auto","position":88.0,"command":"%md\n#### **(5c) Line Plots**\nWe can make line plots of precision, recall, and F-measure as a function of threshold value, for thresholds between 0.0 and 1.0.  You can change `nthresholds` (above in part **(5a)**) to change the threshold values to plot.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.470072583433E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"f47cc46a-45ea-4034-906c-a3223b397594"},{"version":"CommandV1","origId":2632367762420833,"guid":"3d81dfb1-968d-4acd-9179-198400f597a1","subtype":"command","commandType":"auto","position":89.0,"command":"thresholds = [float(n) / nthresholds for n in range(0, nthresholds)]\nfalseposDict = dict([(t, falsepos(t)) for t in thresholds])\nfalsenegDict = dict([(t, falseneg(t)) for t in thresholds])\ntrueposDict = dict([(t, truepos(t)) for t in thresholds])\n\nprecisions = [precision(t) for t in thresholds]\nrecalls = [recall(t) for t in thresholds]\nfmeasures = [fmeasure(t) for t in thresholds]\n\nprint precisions[0], fmeasures[0]\nassert (abs(precisions[0] - 0.000532546802671) < 0.0000001)\nassert (abs(fmeasures[0] - 0.00106452669505) < 0.0000001)\n\n\nfig = plt.figure()\nplt.plot(thresholds, precisions)\nplt.plot(thresholds, recalls)\nplt.plot(thresholds, fmeasures)\nplt.legend(['Precision', 'Recall', 'F-measure'])\ndisplay(fig) \npass","commandVersion":1,"state":"finished","results":{"type":"image","data":"data:image/png;base64,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zqy00kq0bNmSjTbaiNNPP52vvvpqgX233357mjVrxuzZszn//PPZaKONaNmyJeussw6nnXYaP/zwQ+1/0GowfAJSij6bG0DWAl7LsxRJklR3UkqVvn/rrbfo1q0bHTp04OCDD+abb76Z+2Ti/fffZ7vttuP9999n2223Zdddd+Wbb77hgQceoFevXlx//fUcccQRlc532GGHMWTIENq1a8c+++xDu3btmDx5MiNGjKBDhw506dJl7r7z93D861//Yuutt6ZZs2bsvvvurLfeekybNo23336ba6+9lvPPP5/WrVvPPbaqHpBrrrmGE044gWWXXZY+ffrQrl07RowYwcUXX8z999/Pc889xworrLBADf369eOZZ55hl112Yfnll+ehhx5i0KBBfPrpp9x0001L8BNXKTKAlKL3+AxI2AciSVKDN2LECN544w0igi233LLStueee47f//73nHPOOQscd8ghhzB58mSGDRvG3nvvPff1adOmsd122zFgwAB22203VlllFQCuv/56hgwZQrdu3XjsscdYdtll5x6TUmLKlCk11jlkyBB++OEH7r33XnbbbbdK27766qu54aM67733HieffDLLL788L730Ej/5yU/mbuvfvz/XXXcdp512Gtddd12l41JK/Pvf/+b111+fG07OO+88NttsM2677TYuvPBCVl111RqvrYbFAFKKvuVHcCYsSVLjNX06TJpU/Ot26AALuY9eYhUVFQDMnDmTN954g/vuu4+UEr/97W8XaNpeddVV+eMf/7jAOSZMmMDo0aPp06dPpfABsPzyy1NRUcFee+3F3XffTf/+/QG48soriQiuvfbaSuEDsicNC7uJn/M0olWrVgtsm/epRXVuvfVWfvzxRwYMGFApfACcf/75DB06lNtuu42rrrqKFi1aVLruJZdcUukarVq14sADD+Scc85h7Nix7Lrrrgu9vhoOA0jp+gADiCSpkZo0CeYZDVQ0Y8dC5871e42zzz4byG6s27Rpw7bbbssRRxxBv379Fth38803r3QzPseYMWMA+PLLL+cGmnlNmTKFlBKTCilu+vTpvPbaa6y22mpsttlmi1V33759GTx4MHvssQf77bcfPXv2ZJtttmH99dev1fHjx48Hsr6O+a244op06tSJp59+mokTJy5QY5cq/jLMadafOnXqIr4TlToDSOkygEiSGq0OHbIwkMd169u8zdoLs9pqq1X5+ueffw5kDd3VNZxHBN9++y2QBRWANddcc1FKrWSLLbbgmWee4bzzzuOuu+7i1ltvJaVEhw4dGDhwIH369Knx+DlN5tW9pzlT/lbVjF7VjFzNm2e3qYvy81TDYAApXR8A2+ddhCRJ9aF16/p/EtEQVLeY35zhSIMHD+b4449f6HnatGkDwIcffrhE9XTt2pV//OMfzJw5k7Fjx/LII49w5ZVXcsABB7DKKqtU+XRj/po/+eQTNt544wW2f/zxx5X2U9PlNLylyycgkiQ1Ud26dQPg6aefrtX+rVu3ZpNNNuG///0vEyZMWOLrt2jRgm7dujFw4EAGDx7M7Nmzuffee2s8plOnTqSUGDly5ALbvvrqK8aPH0/Lli2rDCdqWgwgpesDoE1UxLIL3VOSJDUqXbp0oXv37txzzz3VTkP76quv8umnn879fsCAAaSU6N+/P19//XWlfWfPns0nn3xS4zXHjBnDjBkzFnh9znEtW7as8fiDDjqIFi1acOWVV/LOO+9U2nbmmWcybdo0Dj744Cp7XtS0OASrdE0u/Lkm8EaehUiSpOIbOnQoPXv25Mgjj+SKK66ga9eutGnThg8++IAJEybw2muvMWbMGNq1awfAkUceyTPPPMOtt97KBhtswB577EG7du348MMPGTFiBEcccUSlGbfmX5Pk4osv5qmnnqJ79+6st956LLvssrz22ms8/PDDtG3blqOPPrrGetddd10uv/xyjj/+eDp37jx3HZBRo0YxZswYOnbsyIUXXrhIP4P5a1TjYAApXR8U/lwLA4gkSQ1CdT0d1e1b0/5rrrkmY8eO5corr+Tuu+9m6NChzJo1i9VWW42OHTty4oknsummm1Y65uabb2bnnXfm+uuvZ9iwYXz//fesvvrqbLfdduy+++411vqb3/yGtm3b8sILL/Dss8/y448/stZaa3H88cfz29/+du6sVDXp378/G264IYMGDeKee+5h+vTprL322vzud7/jjDPOYPnll6/y51DTz0iNT5gsS0dEdAbGAl0YyOvAd8DhqTzdnGthkiRVY86/XWPHjqWzXeVqwMaNGzdnOuAuKaVx1e037/1aTfupevaAlKhUnmYAn2IjuiRJkhoRA0hpcyYsSZIkNSoGkNJmAJEkSVKjYgApbQYQSZIkNSoGkNJmAJEkSVKjYgApbR8AK0VFtMq7EEmSJKkuGEBK25y1QNbMtQpJkiSpjhhAStu8ixFKkiRJDZ4BpLQZQCRJktSoGEBKWCpP04EvMIBIkiSpkTCAlL4PgLXzLkKSJEmqCwaQ0udUvJIkSWo0DCClzwAiSZKkRsMAUvoMIJIkqSgGDhxIWVkZo0ePrvR6WVkZPXr0yKkqNTYGkNL3AbBKVMTSeRciSZKqV1ZWVumrefPmrLTSSuywww7ccssteZdXKxFBRORdhhq55nkXoIWaMxXvGsB/8ixEkiTVLCIYOHAgKSVmzpzJ22+/zfDhwxk1ahRjx47liiuuyLtEKXcGkNI371ogBhBJkkrcWWedVen7MWPG0L17d6655hpOOeUU1l133Zwqk0qDQ7BKn4sRSpLUgG299dZsvPHGpJR46aWXqtzn0UcfZdddd6Vdu3a0bNmSDTbYgNNOO42vvvqqyv0//PBDBgwYwEYbbUTr1q1ZaaWV6Nq1K+eee26l/UaOHMnRRx/Nz372M1ZYYQVat27NJptswsCBA5kxY0adv1epNgwgJS6Vp6+BaRhAJElqsGbPng3A0ksv2NJZUVHBLrvswksvvUTv3r058cQT2XDDDRk0aBC//OUv+frrryvt/9JLL7HZZptx9dVXs9Zaa3HiiSdy4IEHstxyy1FRUVFp34suuognnniCTp06ceyxx3LkkUey9NJLc/bZZ9OrV6+5dUnF5BCshmEyBhBJkhqkZ555hjfeeIOWLVvStWvXSttGjBhBRUUF3bt358EHH2TZZZedu23IkCEcdthhlJeXc+mllwIwc+ZM9ttvP7788kv+9re/0adPn0rn+/DDDyt9/+c//5n27dsvUNOZZ57JBRdcwF133bXAOaT6ZgBpGJyKV5LUqEyfOZ1Jn00q+nU7rNyB1i1a1+s15jyFmDlzJu+88w7Dhw+nWbNm/PnPf6Zdu3aV9r3iiiuICK677rpK4QPgkEMO4fLLL2fo0KFzA8j999/Pe++9x5577lllcFhzzTUrfV9V+AA4+eSTOf/883nssccMICo6A0jD8AGwWd5FSJJUVyZ9Noku13cp+nXHHj2Wzqt3rtdrnH322ZW+Lysr49Zbb6Vv374L7Pv888/TokUL7rzzzirP9cMPP/Dpp58ydepUVlxxRZ5//nkigl69etWqlunTp3P55Zdz77338uabb/L111+TUgKyGbvmf2IiFYMBpGGYDOyedxGSJNWVDit3YOzRY3O5bn2bNWsWAN999x3PPfcchx9+OIcddhirr7462223XaV9P//8c2bNmrVAaJlXRPDNN9+w4oor8uWXXwILPumoyo8//sgOO+zAiy++yKabbkrfvn1p164dLVq0ALJFB7///vvFfZvSYjOANAyvAO2iIlZP5enjvIuRJGlJtW7Rut6fROStVatW9OzZkwceeIAuXbpw6KGHMmnSJFq2bDl3nxVWWIGUEp999lmtztmmTRtgwV6Pqtx33328+OKLHH744dx4442Vtn3yyScMHDiw9m9GqkPOgtUwvFz4s1OuVUiSpEW22WabcdRRRzF58mQuu+yyStu6devG1KlTmThxYq3O1a1bN1JKPProowvd9+233yYi2HvvvRfYNnLkyFpdT6oPBpCG4V3gSwwgkiQ1SGeeeSZLLbUUgwYNqrS2x8knn0xKiaOOOoqPP15wkMP06dN54YUX5n6/22670b59e+69916GDRu2wP7zPhlp3749KSVGjBhRaZ9///vfnH766UREXbw1aZEZQBqAVJ4SMB4DiCRJDdIaa6zBsccey9SpU7nooovmvt6jRw8uuuginn/+eTbccEP69OnD7373O37zm9/Qu3dvVl111Upre7Ro0YJhw4ax4oorsv/++9OzZ0/OOOMMTjrpJH71q1+x3nrrzd13t912Y4MNNuCyyy5j55135vTTT6dfv378/Oc/5xe/+MXcZnSp2AwgDcfLGEAkSSppNT1VOOOMM2jdujVXXXUVn3766dzXTz31VEaPHk3v3r157rnnGDx4MHfddRcfffQRxx577AKrm3fp0oXx48dz3HHH8e6773LZZZdx++238/XXX3POOefM3a9169aMGDGCAw44gNdff50rr7ySV199lfLycm699VYiotZPQRZlX2lhwvRbOiKiMzAW6JJSGldpW0UcDAwB2qTy9FVVx0uSVGxz/u0aO3YsnTs37qZyNW7jxo2jS5cuUMV92Lxqul9T7fgEpOEYX/hz81yrkCRJkpaAAaThmAR8j8OwJEmS1IAZQBqIVJ5mkq0HYgCRJElSg2UAaVhsRJckSVKDZgBpWF4GOkZFLJ13IZIkSdLiMIA0LC8DzYFN8i5EkiRJWhwGkIZlAjAb+HnehUiSJEmLwwDSgKTyNB14E/tAJEmS1EAZQBoeG9ElSZLUYBlAGp6Xgc2jIprlXYgkSZK0qAwgDc/LwDLABnkXIkmSJC0qA0jD83LhT4dhSZIkqcExgDQwqTx9DkzGACJJkqQGyADSMNmILkmSpAbJANIwjQd+HhUReRciSZIyZWVlNX4NGTIk7xKlktA87wK0WF4G2gFrAB/mXIskSSqICAYOHEhKaYFtP/+56whLYABpqOZtRDeASJJUQs4666y8S5BKmkOwGqb3ganYByJJUqNzyy23zB2y9fjjj7Ptttuy3HLL0a5dOw477DCmTp0KwLhx4+jduzdt27ZlueWWY4899uC9996r8pxTp07ljDPOoGPHjrRu3Zo2bdqw44478vjjjy+w77Rp07jkkkvo2bMna6+9NksvvTSrrLIKe+yxB2PGjKny/CNHjqR3796V9t9qq62oqKiotN/2229PWVnVt5/zvu95tW/fnvXXX59p06Zx4okn0r59e5ZaainOPvvsufvMmjWLa665hq233poVVliBZZZZhs6dO3P11VdX+TRK+TKANECpPCVsRJckqdGKCO677z569+7NKqusQv/+/fnpT3/KkCFD2GOPPXjuuefo3r07s2fP5sgjj6R79+7cf//97Lbbbguc6/3336dz585cfPHFrLrqqhx33HH07duXSZMm0atXL2688cZK+0+cOJEzzzyTZs2a0bt3b0455RR22mknnnzySbbddlseeeSRSvs/9NBD9OzZkzFjxrDjjjty6qmnsu+++7LMMstw7bXXLvC+ooYW1qq2RQTff/89PXr04MEHH6RXr14MGDCA9u3bA/Djjz/y61//muOPP55p06Zx4IEHcswxx5BS4oQTTuDQQw+t7Y9dReIQrIbrZWCfvIuQJEmVzf+pP2Sf4i/KjXBKifvvv58RI0awzTbbzH39V7/6FU888QS77rorN954I3379p277ZhjjuGGG25YIIgccsghTJ48mWHDhrH33nvPfX3atGlst912DBgwgN12241VVlkFgI4dO/Lxxx/Ttm3bSjVNnjyZrbbait/+9rf06tVr7us33HADkD0F2XTTTSsd88UXX9T6Pdfkk08+YZNNNuHpp5+mVatWlbade+65PPbYY5x88skMGjRobohJKXHUUUdx0003se+++7L77rvXSS1acgaQhutl4JSoiBVTeZqadzGSJC2S6dNh0qTiX7dDB2jdul4vMe/QoDm22267Rf4k/sADD6wUPgAOPvhgnnjiCTp16lQpfAAcdNBB/OUvf2H8+PFzA8iECRMYPXo0ffr0qRQ+AJZffnkqKirYa6+9uPvuu+nfvz8Ayy23XJX1rL322uy3335cffXVfPDBB6y11loAc4dUzR8MgAVCzJIYNGjQAtdIKXHVVVexxhprVAofkD05+dOf/sRNN93E7bffbgApIQaQhmt84c/NgZE51iFJ0qKbNAm6dCn+dceOhc6d6/USs2bNqnH7qFGjGDlyZKXXqnpC0rmKOtdYY42Fbvvggw/mvjanZ+PLL7+s8snMlClTSCkxab4w+OyzzzJ48GCef/55pkyZwg8//DB3W0Tw4Ycfzg0gBx54IMOHD2errbaib9++bL/99myzzTasueaa1f4MFlXLli0XeLoC8Oabb/LFF1+w0UYbVRn8Ukq0atVqgfenfBlAGq43gBlkfSAj8y1FkqRF1KFDFgbyuG7ORo4cucDN8vxPSCKCFVZYYYFjmzfPbt1q2jZz5sy5r33++ecAPP7441U2nM+51rfffjv3++HDh7PffvvRqlUrdtppJ37yk5+wzDLLUFZWxogRIxg9ejTff//93P332msvHnjgAf70pz/x17/+leuuu46UEltssQUXXnghPXr0WOjPZGHmDA+b35z399Zbb1UZQOaY9/0pfwaQBiqVpx+jIiZgI7okqSFq3bren0SUqvLycsrLy4tyrTlBZfDgwRx//PG1Ouass85i6aWXZuzYsWy00UaVtn300UeMHj16gWN22WUXdtllF7777jteeOEFHnjgAa655hp69+7Nyy+/zE9/+lPgf8O1Zs+evcBsWF9++WW1NVXXuD7n/e21117cddddtXp/yp+zYDVszoQlSZKq1a1bNwCefvrpWh/zzjvv0LFjxwXCR0ppoedp1aoV22+/PYMGDeL3v/8933//PQ8//PDc7SuuuCKQNbTP78UXX6x1jXN06NCBNm3a8Pzzzy906JtKhwGkYXsZ2DgqYsGuL0mS1OR16dKF7t27c88993DTTTdVuc+rr77Kp59+Ovf79u3b89Zbb/Hxxx9X2q+8vJyJEycucPzTTz9d5c3/J598AmT9G3N07dqVlBJ/+ctfKu375JNPcscdd9T+jRU0a9aME044gY8++ogTTjiBGTNmVFlHVXUrPw7B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","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.470072831728E12,"submitTime":1.470072583459E12,"finishTime":1.470072860648E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"cb1ad233-f36d-4b57-8ab9-3f62e2a7d8b0"},{"version":"CommandV1","origId":2632367762420834,"guid":"4f6bed8f-1117-4244-947b-116d04e559f6","subtype":"command","commandType":"auto","position":90.0,"command":"\n# Create a DataFrame and visualize using display()\ngraph = [(t, precision(t), recall(t),fmeasure(t)) for t in thresholds]\ngraphRDD = sc.parallelize(graph)\n\ngraphRow = graphRDD.map(lambda (t, x, y, z): Row(threshold=t, precision=x, recall=y, fmeasure=z))\ngraphDF = sqlContext.createDataFrame(graphRow)\ndisplay(graphDF)","commandVersion":1,"state":"finished","results":{"type":"table","data":[[0.0010645266950540452,5.325468026709271E-4,1.0,0.0],[0.08061002178649238,0.04223433242506812,0.8823076923076923,0.01],[0.1325489705238125,0.0721438790108318,0.8146153846153846,0.02],[0.17584353801427186,0.09929360262660432,0.7676923076923077,0.03],[0.2089183421318657,0.12232013678810996,0.7153846153846154,0.04],[0.23648103309120258,0.14329964134333226,0.6761538461538461,0.05],[0.2601651347561926,0.1631177964446181,0.6423076923076924,0.06],[0.2767495152476644,0.17951063343242626,0.6038461538461538,0.07],[0.2934226073257188,0.19719428268925357,0.573076923076923,0.08],[0.3106838540528731,0.21696673787000306,0.546923076923077,0.09],[0.3255152807391613,0.23519342690859293,0.5284615384615384,0.1],[0.3345177664974619,0.24962121212121213,0.5069230769230769,0.11],[0.3426724137931035,0.263681592039801,0.48923076923076925,0.12],[0.34914285714285714,0.2777272727272727,0.47,0.13],[0.35684147076552136,0.2933597621407334,0.4553846153846154,0.14],[0.3610934520025429,0.3076923076923077,0.4369230769230769,0.15],[0.36249587322548693,0.3175245806824754,0.42230769230769233,0.16],[0.3689784762555518,0.33189920098340503,0.4153846153846154,0.17],[0.3681415929203539,0.34098360655737703,0.4,0.18],[0.3690736688548505,0.3509015256588072,0.3892307692307692,0.19],[0.3715146948003014,0.3641063515509601,0.3792307692307692,0.2],[0.36755485893416934,0.3746006389776358,0.3607692307692308,0.21],[0.36701697655618437,0.38671209540034074,0.34923076923076923,0.22],[0.36484798000832985,0.3978201634877384,0.33692307692307694,0.23],[0.35838641188959663,0.4,0.32461538461538464,0.24],[0.3576673866090712,0.40788177339901477,0.31846153846153846,0.25],[0.3542857142857142,0.41333333333333333,0.31,0.26],[0.3508928571428572,0.41808510638297874,0.30230769230769233,0.27],[0.34454545454545454,0.4211111111111111,0.2915384615384615,0.28],[0.34074074074074073,0.42790697674418604,0.28307692307692306,0.29],[0.33270142180094786,0.43333333333333335,0.27,0.3],[0.32544664413326896,0.437094682230869,0.2592307692307692,0.31],[0.3165115139637433,0.4358974358974359,0.24846153846153846,0.32],[0.3070787637088734,0.43626062322946174,0.23692307692307693,0.33],[0.30535894843276035,0.44542772861356933,0.2323076923076923,0.34],[0.30179028132992325,0.45038167938931295,0.22692307692307692,0.35],[0.2988624612202689,0.4558359621451104,0.22230769230769232,0.36],[0.29212310902451755,0.4538087520259319,0.2153846153846154,0.37],[0.28207847295864263,0.4539249146757679,0.20461538461538462,0.38],[0.2778969957081545,0.4592198581560284,0.19923076923076924,0.39],[0.27421109902067464,0.4684014869888476,0.19384615384615383,0.4],[0.2676211453744493,0.47093023255813954,0.18692307692307691,0.41],[0.2668148971650917,0.48096192384769537,0.18461538461538463,0.42],[0.26292134831460673,0.4875,0.18,0.43],[0.25328009127210493,0.4900662251655629,0.17076923076923076,0.44],[0.2507188039102932,0.49658314350797267,0.1676923076923077,0.45],[0.24404416037187684,0.498812351543943,0.16153846153846155,0.46],[0.23626698168930896,0.5089058524173028,0.15384615384615385,0.47],[0.23164179104477614,0.5173333333333333,0.14923076923076922,0.48],[0.2283987915407855,0.532394366197183,0.1453846153846154,0.49],[0.2189781021897811,0.5232558139534884,0.13846153846153847,0.5],[0.2134969325153374,0.5272727272727272,0.13384615384615384,0.51],[0.20804953560371514,0.5333333333333333,0.12923076923076923,0.52],[0.1997503121098627,0.5298013245033113,0.12307692307692308,0.53],[0.19245283018867926,0.5275862068965518,0.1176923076923077,0.54],[0.18377693282636248,0.5215827338129496,0.11153846153846154,0.55],[0.17474489795918366,0.5111940298507462,0.10538461538461538,0.56],[0.16912235746316462,0.5057471264367817,0.10153846153846154,0.57],[0.16569579288025887,0.5224489795918368,0.09846153846153846,0.58],[0.16374269005847955,0.5271966527196653,0.09692307692307692,0.59],[0.15968586387434555,0.5350877192982456,0.09384615384615384,0.6],[0.1553653719552337,0.5388127853881278,0.09076923076923077,0.61],[0.15435356200527706,0.5416666666666666,0.09,0.62],[0.15079365079365079,0.5377358490566038,0.0876923076923077,0.63],[0.14361702127659576,0.5294117647058824,0.08307692307692308,0.64],[0.14056224899598393,0.5412371134020618,0.08076923076923077,0.65],[0.13458950201884257,0.5376344086021505,0.07692307692307693,0.66],[0.12846517917511835,0.5307262569832403,0.07307692307692308,0.67],[0.12133605998636673,0.5329341317365269,0.06846153846153846,0.68],[0.1179698216735254,0.5443037974683544,0.06615384615384616,0.69],[0.11440385940730531,0.5496688741721855,0.06384615384615384,0.7],[0.10803324099722991,0.5416666666666666,0.06,0.71],[0.10438413361169102,0.5474452554744526,0.057692307692307696,0.72],[0.10216934919524144,0.5658914728682171,0.05615384615384615,0.73],[0.09971910112359551,0.5725806451612904,0.054615384615384614,0.74],[0.09443269908386187,0.5630252100840336,0.05153846153846154,0.75],[0.09200283085633404,0.5752212389380531,0.05,0.76],[0.0908445706174592,0.5871559633027523,0.04923076923076923,0.77],[0.08825622775800712,0.5904761904761905,0.047692307692307694,0.78],[0.08701854493580598,0.5980392156862745,0.04692307692307692,0.79],[0.0842857142857143,0.59,0.045384615384615384,0.8],[0.08172043010752687,0.6,0.04384615384615385,0.81],[0.08034433285509325,0.5957446808510638,0.043076923076923075,0.82],[0.07764198418404025,0.5934065934065934,0.04153846153846154,0.83],[0.07503607503607504,0.6046511627906976,0.04,0.84],[0.0737527114967462,0.6144578313253012,0.03923076923076923,0.85],[0.06976744186046512,0.631578947368421,0.036923076923076927,0.86],[0.0641399416909621,0.6111111111111112,0.033846153846153845,0.87],[0.060029282576866766,0.6212121212121212,0.031538461538461536,0.88],[0.0586940572267058,0.6349206349206349,0.03076923076923077,0.89],[0.05445180279617366,0.6271186440677966,0.02846153846153846,0.9],[0.05453205600589536,0.6491228070175439,0.02846153846153846,0.91],[0.053136531365313655,0.6545454545454545,0.027692307692307693,0.92],[0.048852701702442644,0.6470588235294118,0.025384615384615384,0.93],[0.04599406528189911,0.6458333333333334,0.023846153846153847,0.94],[0.03877703206562267,0.6341463414634146,0.02,0.95],[0.028528528528528527,0.59375,0.014615384615384615,0.96],[0.022624434389140274,0.5769230769230769,0.011538461538461539,0.97],[0.019667170953101363,0.5909090909090909,0.01,0.98],[0.015197568389057753,0.625,0.007692307692307693,0.99]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"fmeasure","type":"\"double\""},{"name":"precision","type":"\"double\""},{"name":"recall","type":"\"double\""},{"name":"threshold","type":"\"double\""}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1.470072860664E12,"submitTime":1.470072583483E12,"finishTime":1.470072860937E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"lineChart","width":"742","height":"325","xColumns":["threshold"],"yColumns":["fmeasure","precision","recall"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{"lineChart":[]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"43af5c7c-28cd-4b40-985b-6ba758cb2751"},{"version":"CommandV1","origId":2632367762420835,"guid":"dee02297-762e-45fe-ba86-b37504496b7b","subtype":"command","commandType":"auto","position":91.0,"command":"%md\n#### Discussion\n \nState-of-the-art tools can get an F-measure of about 60% on this dataset. In this lab exercise, our best F-measure is closer to 40%. Look at some examples of errors (both False Positives and False Negatives) and think about what went wrong.\n \n#### There are several ways we might improve our simple classifier, including:\n* Using additional attributes\n* Performing better featurization of our textual data (e.g., stemming, n-grams, etc.)\n* Using different similarity functions\n* Other - your ideas\n\n#### Include any of the proposed improvements in the model, how does it compare?","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.470072583497E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"e581b390-7b2c-4a39-a3ac-961953b063db"},{"version":"CommandV1","origId":2632367762420836,"guid":"cb6488c1-76f5-415a-88f4-f03821dc6ee0","subtype":"command","commandType":"auto","position":92.0,"command":"%md\n* Using different models and types of classifiers\n\nE.g., [Cost-Effective Crowdsourced Entity Resolution](http://dbgroup.cs.tsinghua.edu.cn/ligl/papers/sigmod16-crowder.pdf)\n\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.470072583516E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"e8896449-22d2-436a-82da-b99a458057fe"}],"dashboards":[],"guid":"b32df6bd-78dc-44b6-94be-e15d3e50f583","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
